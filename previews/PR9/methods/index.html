<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Methods · SPECTrecon.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link rel="canonical" href="https://JeffFessler.github.io/SPECTrecon.jl/stable/methods/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">SPECTrecon.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li class="is-active"><a class="tocitem" href>Methods</a><ul class="internal"><li><a class="tocitem" href="#Methods-list"><span>Methods list</span></a></li><li><a class="tocitem" href="#Methods-usage"><span>Methods usage</span></a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../examples/1-overview/">SPECTrecon overview</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Methods</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Methods</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/main/docs/src/methods.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h2 id="Methods-list"><a class="docs-heading-anchor" href="#Methods-list">Methods list</a><a id="Methods-list-1"></a><a class="docs-heading-anchor-permalink" href="#Methods-list" title="Permalink"></a></h2><ul><li><a href="#SPECTrecon.SPECTrecon"><code>SPECTrecon.SPECTrecon</code></a></li><li><a href="#SPECTrecon.SPECTplan-Tuple{}"><code>SPECTrecon.SPECTplan</code></a></li><li><a href="#SPECTrecon.SPECTplan"><code>SPECTrecon.SPECTplan</code></a></li><li><a href="#SPECTrecon.Workarray"><code>SPECTrecon.Workarray</code></a></li><li><a href="#SPECTrecon.backproject-Tuple{SPECTplan, Vector{Workarray}, AbstractArray{var&quot;#s59&quot;, 3} where var&quot;#s59&quot;&lt;:Number}"><code>SPECTrecon.backproject</code></a></li><li><a href="#SPECTrecon.backproject-Tuple{AbstractArray{var&quot;#s49&quot;, 3} where var&quot;#s49&quot;&lt;:Number, AbstractArray{var&quot;#s30&quot;, 3} where var&quot;#s30&quot;&lt;:Number, AbstractArray{var&quot;#s19&quot;, 4} where var&quot;#s19&quot;&lt;:Number, Number}"><code>SPECTrecon.backproject</code></a></li><li><a href="#SPECTrecon.backproject!-Tuple{AbstractArray{var&quot;#s49&quot;, 3} where var&quot;#s49&quot;&lt;:Number, AbstractArray{var&quot;#s30&quot;, 3} where var&quot;#s30&quot;&lt;:Number, SPECTplan, Vector{Workarray}}"><code>SPECTrecon.backproject!</code></a></li><li><a href="#SPECTrecon.backproject!-Tuple{AbstractArray{var&quot;#s51&quot;, 3} where var&quot;#s51&quot;&lt;:Number, AbstractMatrix{var&quot;#s50&quot;} where var&quot;#s50&quot;&lt;:Number, SPECTplan, Vector{Workarray}, Int64}"><code>SPECTrecon.backproject!</code></a></li><li><a href="#SPECTrecon.copy3dj!-Tuple{AbstractMatrix{T} where T, AbstractArray{var&quot;#s17&quot;, 3} where var&quot;#s17&quot;, Int64}"><code>SPECTrecon.copy3dj!</code></a></li><li><a href="#SPECTrecon.fft_conv!-Tuple{AbstractMatrix{var&quot;#s50&quot;} where var&quot;#s50&quot;&lt;:Number, AbstractMatrix{var&quot;#s49&quot;} where var&quot;#s49&quot;&lt;:Number, AbstractMatrix{var&quot;#s30&quot;} where var&quot;#s30&quot;&lt;:Number, AbstractMatrix{var&quot;#s19&quot;} where var&quot;#s19&quot;&lt;:Number, NTuple{4, Int64}, AbstractMatrix{var&quot;#s59&quot;} where {T&lt;:AbstractFloat, var&quot;#s59&quot;&lt;:Complex{T}}, AbstractMatrix{var&quot;#s59&quot;} where {T&lt;:AbstractFloat, var&quot;#s59&quot;&lt;:Complex{T}}, Union{AbstractFFTs.ScaledPlan, FFTW.cFFTWPlan}, Union{AbstractFFTs.ScaledPlan, FFTW.cFFTWPlan}}"><code>SPECTrecon.fft_conv!</code></a></li><li><a href="#SPECTrecon.fft_conv_adj!-Union{Tuple{T}, Tuple{AbstractMatrix{var&quot;#s18&quot;} where var&quot;#s18&quot;&lt;:Number, AbstractMatrix{var&quot;#s17&quot;} where var&quot;#s17&quot;&lt;:Number, AbstractVector{T}, AbstractVector{T}, AbstractMatrix{var&quot;#s11&quot;} where var&quot;#s11&quot;&lt;:Number, AbstractMatrix{var&quot;#s6&quot;} where var&quot;#s6&quot;&lt;:Number, NTuple{4, Int64}, AbstractMatrix{var&quot;#s59&quot;} where {T&lt;:AbstractFloat, var&quot;#s59&quot;&lt;:Complex{T}}, AbstractMatrix{var&quot;#s59&quot;} where {T&lt;:AbstractFloat, var&quot;#s59&quot;&lt;:Complex{T}}, Union{AbstractFFTs.ScaledPlan, FFTW.cFFTWPlan}, Union{AbstractFFTs.ScaledPlan, FFTW.cFFTWPlan}}} where T"><code>SPECTrecon.fft_conv_adj!</code></a></li><li><a href="#SPECTrecon.fftshift2!-Tuple{AbstractMatrix{T} where T, AbstractMatrix{T} where T}"><code>SPECTrecon.fftshift2!</code></a></li><li><a href="#SPECTrecon.imfilter3!-Tuple{AbstractMatrix{var&quot;#s57&quot;} where var&quot;#s57&quot;&lt;:Number, AbstractMatrix{var&quot;#s59&quot;} where {T&lt;:AbstractFloat, var&quot;#s59&quot;&lt;:Complex{T}}, AbstractMatrix{var&quot;#s53&quot;} where var&quot;#s53&quot;&lt;:Number, AbstractMatrix{var&quot;#s59&quot;} where {T&lt;:AbstractFloat, var&quot;#s59&quot;&lt;:Complex{T}}, Union{AbstractFFTs.ScaledPlan, FFTW.cFFTWPlan}, Union{AbstractFFTs.ScaledPlan, FFTW.cFFTWPlan}}"><code>SPECTrecon.imfilter3!</code></a></li><li><a href="#SPECTrecon.imfilter3_adj!-Tuple{AbstractMatrix{var&quot;#s57&quot;} where var&quot;#s57&quot;&lt;:Number, AbstractMatrix{var&quot;#s59&quot;} where {T&lt;:AbstractFloat, var&quot;#s59&quot;&lt;:Complex{T}}, AbstractMatrix{var&quot;#s53&quot;} where var&quot;#s53&quot;&lt;:Number, AbstractMatrix{var&quot;#s59&quot;} where {T&lt;:AbstractFloat, var&quot;#s59&quot;&lt;:Complex{T}}, Union{AbstractFFTs.ScaledPlan, FFTW.cFFTWPlan}, Union{AbstractFFTs.ScaledPlan, FFTW.cFFTWPlan}}"><code>SPECTrecon.imfilter3_adj!</code></a></li><li><a href="#SPECTrecon.imrotate3!-Tuple{AbstractMatrix{var&quot;#s51&quot;} where var&quot;#s51&quot;&lt;:Number, AbstractMatrix{var&quot;#s50&quot;} where var&quot;#s50&quot;&lt;:Number, AbstractMatrix{var&quot;#s49&quot;} where var&quot;#s49&quot;&lt;:Number, AbstractMatrix{var&quot;#s30&quot;} where var&quot;#s30&quot;&lt;:Number, Real}"><code>SPECTrecon.imrotate3!</code></a></li><li><a href="#SPECTrecon.imrotate3!-Tuple{AbstractMatrix{var&quot;#s17&quot;} where var&quot;#s17&quot;&lt;:Number, AbstractMatrix{var&quot;#s11&quot;} where var&quot;#s11&quot;&lt;:Number, AbstractMatrix{var&quot;#s6&quot;} where var&quot;#s6&quot;&lt;:Number, AbstractMatrix{var&quot;#s5&quot;} where var&quot;#s5&quot;&lt;:Number, Real, LinearInterpolators.SparseInterpolators.SparseInterpolator{var&quot;#s4&quot;, S, N} where {var&quot;#s4&quot;&lt;:AbstractFloat, S, N}, LinearInterpolators.SparseInterpolators.SparseInterpolator{var&quot;#s3&quot;, S, N} where {var&quot;#s3&quot;&lt;:AbstractFloat, S, N}, AbstractVector{var&quot;#s2&quot;} where var&quot;#s2&quot;&lt;:Number, AbstractVector{var&quot;#s57&quot;} where var&quot;#s57&quot;&lt;:Number}"><code>SPECTrecon.imrotate3!</code></a></li><li><a href="#SPECTrecon.imrotate3_adj!-Tuple{AbstractMatrix{var&quot;#s51&quot;} where var&quot;#s51&quot;&lt;:Number, AbstractMatrix{var&quot;#s50&quot;} where var&quot;#s50&quot;&lt;:Number, AbstractMatrix{var&quot;#s49&quot;} where var&quot;#s49&quot;&lt;:Number, AbstractMatrix{var&quot;#s30&quot;} where var&quot;#s30&quot;&lt;:Number, Real}"><code>SPECTrecon.imrotate3_adj!</code></a></li><li><a href="#SPECTrecon.imrotate3_adj!-Tuple{AbstractMatrix{var&quot;#s18&quot;} where var&quot;#s18&quot;&lt;:Number, AbstractMatrix{var&quot;#s17&quot;} where var&quot;#s17&quot;&lt;:Number, AbstractMatrix{var&quot;#s11&quot;} where var&quot;#s11&quot;&lt;:Number, AbstractMatrix{var&quot;#s6&quot;} where var&quot;#s6&quot;&lt;:Number, Real, LinearInterpolators.SparseInterpolators.SparseInterpolator{var&quot;#s5&quot;, S, N} where {var&quot;#s5&quot;&lt;:AbstractFloat, S, N}, LinearInterpolators.SparseInterpolators.SparseInterpolator{var&quot;#s4&quot;, S, N} where {var&quot;#s4&quot;&lt;:AbstractFloat, S, N}, AbstractVector{var&quot;#s3&quot;} where var&quot;#s3&quot;&lt;:Number, AbstractVector{var&quot;#s2&quot;} where var&quot;#s2&quot;&lt;:Number}"><code>SPECTrecon.imrotate3_adj!</code></a></li><li><a href="#SPECTrecon.linearinterp!-Tuple{LinearInterpolators.SparseInterpolators.SparseInterpolator{var&quot;#s6&quot;, S, N} where {var&quot;#s6&quot;&lt;:AbstractFloat, S, N}, AbstractVector{var&quot;#s5&quot;} where var&quot;#s5&quot;&lt;:Number}"><code>SPECTrecon.linearinterp!</code></a></li><li><a href="#SPECTrecon.mul3dj!-Tuple{AbstractArray{var&quot;#s17&quot;, 3} where var&quot;#s17&quot;, AbstractMatrix{T} where T, Int64}"><code>SPECTrecon.mul3dj!</code></a></li><li><a href="#SPECTrecon.pad2sizezero!-Union{Tuple{T}, Tuple{AbstractMatrix{T}, AbstractMatrix{T} where T, Tuple{Int64, Int64}}} where T"><code>SPECTrecon.pad2sizezero!</code></a></li><li><a href="#SPECTrecon.pad_it!-Union{Tuple{T}, Tuple{D}, Tuple{AbstractArray{T, D}, Tuple{Vararg{Int64, D}}}} where {D, T&lt;:Number}"><code>SPECTrecon.pad_it!</code></a></li><li><a href="#SPECTrecon.padrepl!-Tuple{AbstractMatrix{T} where T, AbstractMatrix{T} where T, NTuple{4, Int64}}"><code>SPECTrecon.padrepl!</code></a></li><li><a href="#SPECTrecon.padzero!-Union{Tuple{T}, Tuple{AbstractMatrix{T}, AbstractMatrix{T} where T, NTuple{4, Int64}}} where T"><code>SPECTrecon.padzero!</code></a></li><li><a href="#SPECTrecon.plus1di!-Tuple{AbstractMatrix{T} where T, AbstractVector{T} where T, Int64}"><code>SPECTrecon.plus1di!</code></a></li><li><a href="#SPECTrecon.plus1dj!-Tuple{AbstractMatrix{T} where T, AbstractVector{T} where T, Int64}"><code>SPECTrecon.plus1dj!</code></a></li><li><a href="#SPECTrecon.plus2di!-Tuple{AbstractVector{T} where T, AbstractMatrix{T} where T, Int64}"><code>SPECTrecon.plus2di!</code></a></li><li><a href="#SPECTrecon.plus2dj!-Tuple{AbstractVector{T} where T, AbstractMatrix{T} where T, Int64}"><code>SPECTrecon.plus2dj!</code></a></li><li><a href="#SPECTrecon.plus3di!-Tuple{AbstractMatrix{T} where T, AbstractArray{var&quot;#s17&quot;, 3} where var&quot;#s17&quot;, Int64}"><code>SPECTrecon.plus3di!</code></a></li><li><a href="#SPECTrecon.plus3dj!-Tuple{AbstractMatrix{T} where T, AbstractArray{var&quot;#s17&quot;, 3} where var&quot;#s17&quot;, Int64}"><code>SPECTrecon.plus3dj!</code></a></li><li><a href="#SPECTrecon.plus3dk!-Tuple{AbstractMatrix{T} where T, AbstractArray{var&quot;#s17&quot;, 3} where var&quot;#s17&quot;, Int64}"><code>SPECTrecon.plus3dk!</code></a></li><li><a href="#SPECTrecon.project-Tuple{AbstractArray{var&quot;#s59&quot;, 3} where var&quot;#s59&quot;&lt;:Number, SPECTplan, Vector{Workarray}}"><code>SPECTrecon.project</code></a></li><li><a href="#SPECTrecon.project-Tuple{AbstractArray{var&quot;#s49&quot;, 3} where var&quot;#s49&quot;&lt;:Number, AbstractArray{var&quot;#s30&quot;, 3} where var&quot;#s30&quot;&lt;:Number, AbstractArray{var&quot;#s19&quot;, 4} where var&quot;#s19&quot;&lt;:Number, Number}"><code>SPECTrecon.project</code></a></li><li><a href="#SPECTrecon.project!-Tuple{AbstractArray{var&quot;#s49&quot;, 3} where var&quot;#s49&quot;&lt;:Number, AbstractArray{var&quot;#s30&quot;, 3} where var&quot;#s30&quot;&lt;:Number, SPECTplan, Vector{Workarray}}"><code>SPECTrecon.project!</code></a></li><li><a href="#SPECTrecon.project!-Tuple{AbstractMatrix{var&quot;#s52&quot;} where var&quot;#s52&quot;&lt;:Number, AbstractArray{var&quot;#s51&quot;, 3} where var&quot;#s51&quot;&lt;:Number, SPECTplan, Vector{Workarray}, Int64}"><code>SPECTrecon.project!</code></a></li><li><a href="#SPECTrecon.rot180!-Tuple{AbstractMatrix{T} where T, AbstractMatrix{T} where T}"><code>SPECTrecon.rot180!</code></a></li><li><a href="#SPECTrecon.rot_f90!-Tuple{AbstractMatrix{T} where T, AbstractMatrix{T} where T, Int64}"><code>SPECTrecon.rot_f90!</code></a></li><li><a href="#SPECTrecon.rot_f90_adj!-Tuple{AbstractMatrix{T} where T, AbstractMatrix{T} where T, Int64}"><code>SPECTrecon.rot_f90_adj!</code></a></li><li><a href="#SPECTrecon.rotate_x!-Tuple{AbstractMatrix{var&quot;#s4&quot;} where var&quot;#s4&quot;&lt;:Number, AbstractMatrix{var&quot;#s3&quot;} where var&quot;#s3&quot;&lt;:Number, Real, AbstractVector{var&quot;#s2&quot;} where var&quot;#s2&quot;&lt;:Number, AbstractVector{var&quot;#s49&quot;} where var&quot;#s49&quot;&lt;:Number, LinearInterpolators.SparseInterpolators.SparseInterpolator{var&quot;#s50&quot;, S, N} where {var&quot;#s50&quot;&lt;:AbstractFloat, S, N}, AbstractVector{var&quot;#s51&quot;} where var&quot;#s51&quot;&lt;:Number, Real}"><code>SPECTrecon.rotate_x!</code></a></li><li><a href="#SPECTrecon.rotate_x_adj!-Tuple{AbstractMatrix{var&quot;#s19&quot;} where var&quot;#s19&quot;&lt;:Number, AbstractMatrix{var&quot;#s18&quot;} where var&quot;#s18&quot;&lt;:Number, Real, AbstractVector{var&quot;#s17&quot;} where var&quot;#s17&quot;&lt;:Number, AbstractVector{var&quot;#s11&quot;} where var&quot;#s11&quot;&lt;:Number, LinearInterpolators.SparseInterpolators.SparseInterpolator, AbstractVector{var&quot;#s6&quot;} where var&quot;#s6&quot;&lt;:Number, Real}"><code>SPECTrecon.rotate_x_adj!</code></a></li><li><a href="#SPECTrecon.rotate_y!-Tuple{AbstractMatrix{var&quot;#s19&quot;} where var&quot;#s19&quot;&lt;:Number, AbstractMatrix{var&quot;#s18&quot;} where var&quot;#s18&quot;&lt;:Number, Real, AbstractVector{var&quot;#s17&quot;} where var&quot;#s17&quot;&lt;:Number, AbstractVector{var&quot;#s11&quot;} where var&quot;#s11&quot;&lt;:Number, LinearInterpolators.SparseInterpolators.SparseInterpolator, AbstractVector{var&quot;#s6&quot;} where var&quot;#s6&quot;&lt;:Number, Real}"><code>SPECTrecon.rotate_y!</code></a></li><li><a href="#SPECTrecon.rotate_y_adj!-Tuple{AbstractMatrix{var&quot;#s19&quot;} where var&quot;#s19&quot;&lt;:Number, AbstractMatrix{var&quot;#s18&quot;} where var&quot;#s18&quot;&lt;:Number, Real, AbstractVector{var&quot;#s17&quot;} where var&quot;#s17&quot;&lt;:Number, AbstractVector{var&quot;#s11&quot;} where var&quot;#s11&quot;&lt;:Number, LinearInterpolators.SparseInterpolators.SparseInterpolator, AbstractVector{var&quot;#s6&quot;} where var&quot;#s6&quot;&lt;:Number, Real}"><code>SPECTrecon.rotate_y_adj!</code></a></li><li><a href="#SPECTrecon.rotl90!-Tuple{AbstractMatrix{T} where T, AbstractMatrix{T} where T}"><code>SPECTrecon.rotl90!</code></a></li><li><a href="#SPECTrecon.rotr90!-Tuple{AbstractMatrix{T} where T, AbstractMatrix{T} where T}"><code>SPECTrecon.rotr90!</code></a></li><li><a href="#SPECTrecon.scale3dj!-Tuple{AbstractMatrix{T} where T, AbstractArray{var&quot;#s17&quot;, 3} where var&quot;#s17&quot;, Int64, Number}"><code>SPECTrecon.scale3dj!</code></a></li></ul><h2 id="Methods-usage"><a class="docs-heading-anchor" href="#Methods-usage">Methods usage</a><a id="Methods-usage-1"></a><a class="docs-heading-anchor-permalink" href="#Methods-usage" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.SPECTrecon" href="#SPECTrecon.SPECTrecon"><code>SPECTrecon.SPECTrecon</code></a> — <span class="docstring-category">Module</span></header><section><div><pre><code class="language-julia hljs">SPECTrecon</code></pre><p>System matrix (forward and back-projector) for SPECT image reconstruction.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/e1593dccc16260d5c2baab8faae33c2f225e8c5f/src/SPECTrecon.jl#L1-L4">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.SPECTplan" href="#SPECTrecon.SPECTplan"><code>SPECTrecon.SPECTplan</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">SPECTplan</code></pre><p>Struct for storing key factors for a SPECT system model</p><ul><li><code>T</code> datatype of work arrays</li><li><code>imgr [nx, ny, nz]</code> 3D rotated version of image</li><li><code>add_img [nx, ny, nz]</code> 3D image for adding views and backprojection</li><li><code>mumap [nx,ny,nz]</code> attenuation map, must be 3D, possibly zeros()</li><li><code>mumapr [nx, ny, nz]</code> 3D rotated mumap</li><li><code>psfs [nx_psf,nz_psf,ny,nview]</code> point spread function, must be 4D, with <code>nx_psf</code> and <code>nz_psf</code> odd, and symmetric for each slice</li><li><code>nview</code> number of views, must be integer</li><li><code>viewangle</code> set of view angles, must be from 0 to 2π</li><li><code>interpidx</code> interpolation method, 1 means 1d, 2 means 2d</li><li><code>dy</code> voxel size in y direction (dx is the same value)</li><li><code>imgsize{nx, ny, nz}</code> number of voxels in {x,y,z} direction of the image, must be integer</li><li><code>psfsize{nx_psf, nz_psf}</code> number of voxels in {x, z} direction of the psf, must be integer</li><li><code>pad_fft{padu_fft, pad_fft, padl_fft, padr_fft}</code> pixels padded for {left,right,up,down} direction for convolution with psfs, must be integer</li><li><code>pad_rot{padu_rot, padd_rot, padl_rot, padr_rot}</code> padded pixels for {left,right,up,down} direction for image rotation</li><li><code>ncore</code> number of CPU cores used to process data, must be integer</li></ul><p>Currently code assumes the following:</p><ul><li>each of the <code>nview</code> projection views is <code>[nx,nz]</code></li><li><code>nx = ny</code></li><li>uniform angular sampling</li><li><code>psf</code> is symmetric</li><li>multiprocessing using # of cores specified by <code>Threads.nthreads()</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/e1593dccc16260d5c2baab8faae33c2f225e8c5f/src/spectplan.jl#L5-L29">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.SPECTplan-Tuple{}" href="#SPECTrecon.SPECTplan-Tuple{}"><code>SPECTrecon.SPECTplan</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">SPECTplan(mumap, psfs, dy; viewangle, interpidx, T)</code></pre><p>Constructor for <code>SPECTplan</code></p><p>In</p><ul><li><code>mumap::AbstractArray{&lt;:RealU, 3}</code> 3D attenuation map</li><li><code>psfs::AbstractArray{&lt;:RealU, 4}</code> 4D PSF array</li><li><code>dy::RealU</code> pixel size</li></ul><p>Option</p><ul><li><code>viewangle::AbstractVector{&lt;:RealU}</code> default 0 to almost 2π</li><li><code>interpidx::Int = 2</code> 1 is for 3-pass 1D interpolator; 2 is for 2D interpolator</li><li><code>T::DataType = promote_type(eltype(mumap), Float32)</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/e1593dccc16260d5c2baab8faae33c2f225e8c5f/src/spectplan.jl#L104-L118">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.Workarray" href="#SPECTrecon.Workarray"><code>SPECTrecon.Workarray</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Workarray</code></pre><p>Struct for storing keys of the work array for a single thread add tmp vectors to avoid allocating in rotate<em>x and rotate</em>y For fft convolution:</p><ul><li><code>workmat_fft [nx+padu_fft+padd_fft, nz+padl_fft+padr_fft]</code>: 2D padded image for imfilter3</li><li><code>workvec_fft_1 [nz+padl_fft+padr_fft,]</code>: 1D work vector</li><li><code>workvec_fft_2 [nx+padu_fft+padd_fft,]</code>: 1D work vector</li><li><code>img_compl [nx+padu_fft+padd_fft, nz+padl_fft+padr_fft]</code>: 2D [complex] padded image for fft</li><li><code>ker_compl [nx+padu_fft+padd_fft, nz+padl_fft+padr_fft]</code>: 2D [complex] padded image for fft</li><li><code>fft_plan</code> plan for doing fft, see plan_fft!</li><li><code>ifft_plan</code> plan for doing ifft, see plan_ifft!</li></ul><p>For image rotation:</p><ul><li><code>workmat_rot_1 [nx+padu_rot+padd_rot, ny+padl_rot+padr_rot]</code>: 2D padded image for image rotation</li><li><code>workmat_rot_2 [nx+padu_rot+padd_rot, ny+padl_rot+padr_rot]</code>: 2D padded image for image rotation</li><li><code>workvec_rot_x [nx+padu_rot+padd_rot,]</code>: 1D work vector for image rotation</li><li><code>workvec_rot_y [ny+padl_rot+padr_rot,]</code>: 1D work vector for image rotation</li><li><code>interp_x</code> sparse interpolator for rotating in x direction</li><li><code>interp_y</code> sparse interpolator for rotating in y direction</li></ul><p>For attenuation:</p><ul><li><code>exp_mumapr [nx, nz]</code> 2D exponential rotated mumap</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/e1593dccc16260d5c2baab8faae33c2f225e8c5f/src/spectplan.jl#L122-L143">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.backproject!-Tuple{AbstractArray{var&quot;#s49&quot;, 3} where var&quot;#s49&quot;&lt;:Number, AbstractArray{var&quot;#s30&quot;, 3} where var&quot;#s30&quot;&lt;:Number, SPECTplan, Vector{Workarray}}" href="#SPECTrecon.backproject!-Tuple{AbstractArray{var&quot;#s49&quot;, 3} where var&quot;#s49&quot;&lt;:Number, AbstractArray{var&quot;#s30&quot;, 3} where var&quot;#s30&quot;&lt;:Number, SPECTplan, Vector{Workarray}}"><code>SPECTrecon.backproject!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">backproject!(image, views, plan, workarray; index)</code></pre><p>Backproject multiple views into <code>image</code>. Array <code>image</code> is not initialized to zero; caller must do that.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/e1593dccc16260d5c2baab8faae33c2f225e8c5f/src/backproject.jl#L96-L100">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.backproject!-Tuple{AbstractArray{var&quot;#s51&quot;, 3} where var&quot;#s51&quot;&lt;:Number, AbstractMatrix{var&quot;#s50&quot;} where var&quot;#s50&quot;&lt;:Number, SPECTplan, Vector{Workarray}, Int64}" href="#SPECTrecon.backproject!-Tuple{AbstractArray{var&quot;#s51&quot;, 3} where var&quot;#s51&quot;&lt;:Number, AbstractMatrix{var&quot;#s50&quot;} where var&quot;#s50&quot;&lt;:Number, SPECTplan, Vector{Workarray}, Int64}"><code>SPECTrecon.backproject!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">backproject!(image, view, plan, workarray, viewidx)</code></pre><p>Backproject a single view.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/e1593dccc16260d5c2baab8faae33c2f225e8c5f/src/backproject.jl#L5-L8">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.backproject-Tuple{AbstractArray{var&quot;#s49&quot;, 3} where var&quot;#s49&quot;&lt;:Number, AbstractArray{var&quot;#s30&quot;, 3} where var&quot;#s30&quot;&lt;:Number, AbstractArray{var&quot;#s19&quot;, 4} where var&quot;#s19&quot;&lt;:Number, Number}" href="#SPECTrecon.backproject-Tuple{AbstractArray{var&quot;#s49&quot;, 3} where var&quot;#s49&quot;&lt;:Number, AbstractArray{var&quot;#s30&quot;, 3} where var&quot;#s30&quot;&lt;:Number, AbstractArray{var&quot;#s19&quot;, 4} where var&quot;#s19&quot;&lt;:Number, Number}"><code>SPECTrecon.backproject</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">image = backproject(views, mumap, psfs, dy; interpidx, kwargs...)</code></pre><p>SPECT backproject <code>views</code> using attenuation map <code>mumap</code> and PSF array <code>psfs</code> for pixel size <code>dy</code>. This method initializes the <code>plan</code> and <code>workarray</code> as a convenience. Most users should use <code>backproject!</code> instead after initializing those, for better efficiency.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/e1593dccc16260d5c2baab8faae33c2f225e8c5f/src/backproject.jl#L134-L139">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.backproject-Tuple{SPECTplan, Vector{Workarray}, AbstractArray{var&quot;#s59&quot;, 3} where var&quot;#s59&quot;&lt;:Number}" href="#SPECTrecon.backproject-Tuple{SPECTplan, Vector{Workarray}, AbstractArray{var&quot;#s59&quot;, 3} where var&quot;#s59&quot;&lt;:Number}"><code>SPECTrecon.backproject</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">image = backproject(plan, workarray, views ; kwargs...)</code></pre><p>SPECT backproject <code>views</code>; this allocates the returned 3D array.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/e1593dccc16260d5c2baab8faae33c2f225e8c5f/src/backproject.jl#L118-L121">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.copy3dj!-Tuple{AbstractMatrix{T} where T, AbstractArray{var&quot;#s17&quot;, 3} where var&quot;#s17&quot;, Int64}" href="#SPECTrecon.copy3dj!-Tuple{AbstractMatrix{T} where T, AbstractArray{var&quot;#s17&quot;, 3} where var&quot;#s17&quot;, Int64}"><code>SPECTrecon.copy3dj!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">copy3dj!(mat2d, mat3d, j)</code></pre><p>Non-allocating <code>mat2d .= mat3d[:,j,:]</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/e1593dccc16260d5c2baab8faae33c2f225e8c5f/src/helper.jl#L306-L309">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.fft_conv!-Tuple{AbstractMatrix{var&quot;#s50&quot;} where var&quot;#s50&quot;&lt;:Number, AbstractMatrix{var&quot;#s49&quot;} where var&quot;#s49&quot;&lt;:Number, AbstractMatrix{var&quot;#s30&quot;} where var&quot;#s30&quot;&lt;:Number, AbstractMatrix{var&quot;#s19&quot;} where var&quot;#s19&quot;&lt;:Number, NTuple{4, Int64}, AbstractMatrix{var&quot;#s59&quot;} where {T&lt;:AbstractFloat, var&quot;#s59&quot;&lt;:Complex{T}}, AbstractMatrix{var&quot;#s59&quot;} where {T&lt;:AbstractFloat, var&quot;#s59&quot;&lt;:Complex{T}}, Union{AbstractFFTs.ScaledPlan, FFTW.cFFTWPlan}, Union{AbstractFFTs.ScaledPlan, FFTW.cFFTWPlan}}" href="#SPECTrecon.fft_conv!-Tuple{AbstractMatrix{var&quot;#s50&quot;} where var&quot;#s50&quot;&lt;:Number, AbstractMatrix{var&quot;#s49&quot;} where var&quot;#s49&quot;&lt;:Number, AbstractMatrix{var&quot;#s30&quot;} where var&quot;#s30&quot;&lt;:Number, AbstractMatrix{var&quot;#s19&quot;} where var&quot;#s19&quot;&lt;:Number, NTuple{4, Int64}, AbstractMatrix{var&quot;#s59&quot;} where {T&lt;:AbstractFloat, var&quot;#s59&quot;&lt;:Complex{T}}, AbstractMatrix{var&quot;#s59&quot;} where {T&lt;:AbstractFloat, var&quot;#s59&quot;&lt;:Complex{T}}, Union{AbstractFFTs.ScaledPlan, FFTW.cFFTWPlan}, Union{AbstractFFTs.ScaledPlan, FFTW.cFFTWPlan}}"><code>SPECTrecon.fft_conv!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">fft_conv!(output, workmat, img, ker, fftpadsize, img_compl, ker_compl, fft_plan, ifft_plan)</code></pre><p>Convolve <code>img</code> with <code>ker</code> using FFT, and store the result in <code>output</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/e1593dccc16260d5c2baab8faae33c2f225e8c5f/src/fft_convolve.jl#L64-L67">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.fft_conv_adj!-Union{Tuple{T}, Tuple{AbstractMatrix{var&quot;#s18&quot;} where var&quot;#s18&quot;&lt;:Number, AbstractMatrix{var&quot;#s17&quot;} where var&quot;#s17&quot;&lt;:Number, AbstractVector{T}, AbstractVector{T}, AbstractMatrix{var&quot;#s11&quot;} where var&quot;#s11&quot;&lt;:Number, AbstractMatrix{var&quot;#s6&quot;} where var&quot;#s6&quot;&lt;:Number, NTuple{4, Int64}, AbstractMatrix{var&quot;#s59&quot;} where {T&lt;:AbstractFloat, var&quot;#s59&quot;&lt;:Complex{T}}, AbstractMatrix{var&quot;#s59&quot;} where {T&lt;:AbstractFloat, var&quot;#s59&quot;&lt;:Complex{T}}, Union{AbstractFFTs.ScaledPlan, FFTW.cFFTWPlan}, Union{AbstractFFTs.ScaledPlan, FFTW.cFFTWPlan}}} where T" href="#SPECTrecon.fft_conv_adj!-Union{Tuple{T}, Tuple{AbstractMatrix{var&quot;#s18&quot;} where var&quot;#s18&quot;&lt;:Number, AbstractMatrix{var&quot;#s17&quot;} where var&quot;#s17&quot;&lt;:Number, AbstractVector{T}, AbstractVector{T}, AbstractMatrix{var&quot;#s11&quot;} where var&quot;#s11&quot;&lt;:Number, AbstractMatrix{var&quot;#s6&quot;} where var&quot;#s6&quot;&lt;:Number, NTuple{4, Int64}, AbstractMatrix{var&quot;#s59&quot;} where {T&lt;:AbstractFloat, var&quot;#s59&quot;&lt;:Complex{T}}, AbstractMatrix{var&quot;#s59&quot;} where {T&lt;:AbstractFloat, var&quot;#s59&quot;&lt;:Complex{T}}, Union{AbstractFFTs.ScaledPlan, FFTW.cFFTWPlan}, Union{AbstractFFTs.ScaledPlan, FFTW.cFFTWPlan}}} where T"><code>SPECTrecon.fft_conv_adj!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">fft_conv_adj!(output, workmat, workvec1, workvec2, img, ker,
              fftpadsize, img_compl, ker_compl, fft_plan, ifft_plan)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/e1593dccc16260d5c2baab8faae33c2f225e8c5f/src/fft_convolve.jl#L90-L93">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.fftshift2!-Tuple{AbstractMatrix{T} where T, AbstractMatrix{T} where T}" href="#SPECTrecon.fftshift2!-Tuple{AbstractMatrix{T} where T, AbstractMatrix{T} where T}"><code>SPECTrecon.fftshift2!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">fftshift2!(dst, src)</code></pre><p>Same as <code>fftshift</code> in 2d, but non-allocating</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/e1593dccc16260d5c2baab8faae33c2f225e8c5f/src/helper.jl#L109-L112">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.imfilter3!-Tuple{AbstractMatrix{var&quot;#s57&quot;} where var&quot;#s57&quot;&lt;:Number, AbstractMatrix{var&quot;#s59&quot;} where {T&lt;:AbstractFloat, var&quot;#s59&quot;&lt;:Complex{T}}, AbstractMatrix{var&quot;#s53&quot;} where var&quot;#s53&quot;&lt;:Number, AbstractMatrix{var&quot;#s59&quot;} where {T&lt;:AbstractFloat, var&quot;#s59&quot;&lt;:Complex{T}}, Union{AbstractFFTs.ScaledPlan, FFTW.cFFTWPlan}, Union{AbstractFFTs.ScaledPlan, FFTW.cFFTWPlan}}" href="#SPECTrecon.imfilter3!-Tuple{AbstractMatrix{var&quot;#s57&quot;} where var&quot;#s57&quot;&lt;:Number, AbstractMatrix{var&quot;#s59&quot;} where {T&lt;:AbstractFloat, var&quot;#s59&quot;&lt;:Complex{T}}, AbstractMatrix{var&quot;#s53&quot;} where var&quot;#s53&quot;&lt;:Number, AbstractMatrix{var&quot;#s59&quot;} where {T&lt;:AbstractFloat, var&quot;#s59&quot;&lt;:Complex{T}}, Union{AbstractFFTs.ScaledPlan, FFTW.cFFTWPlan}, Union{AbstractFFTs.ScaledPlan, FFTW.cFFTWPlan}}"><code>SPECTrecon.imfilter3!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">imfilter3!(output, img_compl, ker, ker_compl, fft_plan, ifft_plan)</code></pre><p>FFT-based convolution between <code>img_compl</code> and kernel <code>ker</code> (not centered) putting result in <code>output</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/e1593dccc16260d5c2baab8faae33c2f225e8c5f/src/fft_convolve.jl#L12-L16">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.imfilter3_adj!-Tuple{AbstractMatrix{var&quot;#s57&quot;} where var&quot;#s57&quot;&lt;:Number, AbstractMatrix{var&quot;#s59&quot;} where {T&lt;:AbstractFloat, var&quot;#s59&quot;&lt;:Complex{T}}, AbstractMatrix{var&quot;#s53&quot;} where var&quot;#s53&quot;&lt;:Number, AbstractMatrix{var&quot;#s59&quot;} where {T&lt;:AbstractFloat, var&quot;#s59&quot;&lt;:Complex{T}}, Union{AbstractFFTs.ScaledPlan, FFTW.cFFTWPlan}, Union{AbstractFFTs.ScaledPlan, FFTW.cFFTWPlan}}" href="#SPECTrecon.imfilter3_adj!-Tuple{AbstractMatrix{var&quot;#s57&quot;} where var&quot;#s57&quot;&lt;:Number, AbstractMatrix{var&quot;#s59&quot;} where {T&lt;:AbstractFloat, var&quot;#s59&quot;&lt;:Complex{T}}, AbstractMatrix{var&quot;#s53&quot;} where var&quot;#s53&quot;&lt;:Number, AbstractMatrix{var&quot;#s59&quot;} where {T&lt;:AbstractFloat, var&quot;#s59&quot;&lt;:Complex{T}}, Union{AbstractFFTs.ScaledPlan, FFTW.cFFTWPlan}, Union{AbstractFFTs.ScaledPlan, FFTW.cFFTWPlan}}"><code>SPECTrecon.imfilter3_adj!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">imfilter3_adj!(output, img_compl, kerev, ker_compl, fft_plan, ifft_plan)</code></pre><p>Apply FFT convolution between <code>img_compl</code> and <em>REVERSED</em> kernel (not centered), assuming the kernel is already be in reversed order.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/e1593dccc16260d5c2baab8faae33c2f225e8c5f/src/fft_convolve.jl#L38-L42">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.imrotate3!-Tuple{AbstractMatrix{var&quot;#s17&quot;} where var&quot;#s17&quot;&lt;:Number, AbstractMatrix{var&quot;#s11&quot;} where var&quot;#s11&quot;&lt;:Number, AbstractMatrix{var&quot;#s6&quot;} where var&quot;#s6&quot;&lt;:Number, AbstractMatrix{var&quot;#s5&quot;} where var&quot;#s5&quot;&lt;:Number, Real, LinearInterpolators.SparseInterpolators.SparseInterpolator{var&quot;#s4&quot;, S, N} where {var&quot;#s4&quot;&lt;:AbstractFloat, S, N}, LinearInterpolators.SparseInterpolators.SparseInterpolator{var&quot;#s3&quot;, S, N} where {var&quot;#s3&quot;&lt;:AbstractFloat, S, N}, AbstractVector{var&quot;#s2&quot;} where var&quot;#s2&quot;&lt;:Number, AbstractVector{var&quot;#s57&quot;} where var&quot;#s57&quot;&lt;:Number}" href="#SPECTrecon.imrotate3!-Tuple{AbstractMatrix{var&quot;#s17&quot;} where var&quot;#s17&quot;&lt;:Number, AbstractMatrix{var&quot;#s11&quot;} where var&quot;#s11&quot;&lt;:Number, AbstractMatrix{var&quot;#s6&quot;} where var&quot;#s6&quot;&lt;:Number, AbstractMatrix{var&quot;#s5&quot;} where var&quot;#s5&quot;&lt;:Number, Real, LinearInterpolators.SparseInterpolators.SparseInterpolator{var&quot;#s4&quot;, S, N} where {var&quot;#s4&quot;&lt;:AbstractFloat, S, N}, LinearInterpolators.SparseInterpolators.SparseInterpolator{var&quot;#s3&quot;, S, N} where {var&quot;#s3&quot;&lt;:AbstractFloat, S, N}, AbstractVector{var&quot;#s2&quot;} where var&quot;#s2&quot;&lt;:Number, AbstractVector{var&quot;#s57&quot;} where var&quot;#s57&quot;&lt;:Number}"><code>SPECTrecon.imrotate3!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">imrotate3!(output, workmat1, workmat2, img, θ, interp_x, interp_y, workvec_x, workvec_y)</code></pre><p>Rotate an image by angle θ (must be within 0 to 2π) in clockwise direction using a series of 1d linear interpolations.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/e1593dccc16260d5c2baab8faae33c2f225e8c5f/src/rotate3.jl#L251-L255">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.imrotate3!-Tuple{AbstractMatrix{var&quot;#s51&quot;} where var&quot;#s51&quot;&lt;:Number, AbstractMatrix{var&quot;#s50&quot;} where var&quot;#s50&quot;&lt;:Number, AbstractMatrix{var&quot;#s49&quot;} where var&quot;#s49&quot;&lt;:Number, AbstractMatrix{var&quot;#s30&quot;} where var&quot;#s30&quot;&lt;:Number, Real}" href="#SPECTrecon.imrotate3!-Tuple{AbstractMatrix{var&quot;#s51&quot;} where var&quot;#s51&quot;&lt;:Number, AbstractMatrix{var&quot;#s50&quot;} where var&quot;#s50&quot;&lt;:Number, AbstractMatrix{var&quot;#s49&quot;} where var&quot;#s49&quot;&lt;:Number, AbstractMatrix{var&quot;#s30&quot;} where var&quot;#s30&quot;&lt;:Number, Real}"><code>SPECTrecon.imrotate3!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">imrotate3!(output, workmat1, workmat2, img, θ)</code></pre><p>Rotate an image by angle θ in clockwise direction using 2d linear interpolation Source code is here: https://github.com/emmt/LinearInterpolators.jl</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/e1593dccc16260d5c2baab8faae33c2f225e8c5f/src/rotate3.jl#L350-L354">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.imrotate3_adj!-Tuple{AbstractMatrix{var&quot;#s18&quot;} where var&quot;#s18&quot;&lt;:Number, AbstractMatrix{var&quot;#s17&quot;} where var&quot;#s17&quot;&lt;:Number, AbstractMatrix{var&quot;#s11&quot;} where var&quot;#s11&quot;&lt;:Number, AbstractMatrix{var&quot;#s6&quot;} where var&quot;#s6&quot;&lt;:Number, Real, LinearInterpolators.SparseInterpolators.SparseInterpolator{var&quot;#s5&quot;, S, N} where {var&quot;#s5&quot;&lt;:AbstractFloat, S, N}, LinearInterpolators.SparseInterpolators.SparseInterpolator{var&quot;#s4&quot;, S, N} where {var&quot;#s4&quot;&lt;:AbstractFloat, S, N}, AbstractVector{var&quot;#s3&quot;} where var&quot;#s3&quot;&lt;:Number, AbstractVector{var&quot;#s2&quot;} where var&quot;#s2&quot;&lt;:Number}" href="#SPECTrecon.imrotate3_adj!-Tuple{AbstractMatrix{var&quot;#s18&quot;} where var&quot;#s18&quot;&lt;:Number, AbstractMatrix{var&quot;#s17&quot;} where var&quot;#s17&quot;&lt;:Number, AbstractMatrix{var&quot;#s11&quot;} where var&quot;#s11&quot;&lt;:Number, AbstractMatrix{var&quot;#s6&quot;} where var&quot;#s6&quot;&lt;:Number, Real, LinearInterpolators.SparseInterpolators.SparseInterpolator{var&quot;#s5&quot;, S, N} where {var&quot;#s5&quot;&lt;:AbstractFloat, S, N}, LinearInterpolators.SparseInterpolators.SparseInterpolator{var&quot;#s4&quot;, S, N} where {var&quot;#s4&quot;&lt;:AbstractFloat, S, N}, AbstractVector{var&quot;#s3&quot;} where var&quot;#s3&quot;&lt;:Number, AbstractVector{var&quot;#s2&quot;} where var&quot;#s2&quot;&lt;:Number}"><code>SPECTrecon.imrotate3_adj!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">imrotate3_adj!(output, workmat1, workmat2, img, θ, interp_x, interp_y, workvec_x, workvec_y)</code></pre><p>The adjoint of rotating an image by angle θ (must be ranging from 0 to 2π) in clockwise direction using a series of 1d linear interpolation</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/e1593dccc16260d5c2baab8faae33c2f225e8c5f/src/rotate3.jl#L300-L304">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.imrotate3_adj!-Tuple{AbstractMatrix{var&quot;#s51&quot;} where var&quot;#s51&quot;&lt;:Number, AbstractMatrix{var&quot;#s50&quot;} where var&quot;#s50&quot;&lt;:Number, AbstractMatrix{var&quot;#s49&quot;} where var&quot;#s49&quot;&lt;:Number, AbstractMatrix{var&quot;#s30&quot;} where var&quot;#s30&quot;&lt;:Number, Real}" href="#SPECTrecon.imrotate3_adj!-Tuple{AbstractMatrix{var&quot;#s51&quot;} where var&quot;#s51&quot;&lt;:Number, AbstractMatrix{var&quot;#s50&quot;} where var&quot;#s50&quot;&lt;:Number, AbstractMatrix{var&quot;#s49&quot;} where var&quot;#s49&quot;&lt;:Number, AbstractMatrix{var&quot;#s30&quot;} where var&quot;#s30&quot;&lt;:Number, Real}"><code>SPECTrecon.imrotate3_adj!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">imrotate3_adj!(output, workmat1, workmat2, img, θ)</code></pre><p>The adjoint of rotating an image by angle θ in clockwise direction using 2d linear interpolation Source code is here: https://github.com/emmt/LinearInterpolators.jl</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/e1593dccc16260d5c2baab8faae33c2f225e8c5f/src/rotate3.jl#L387-L391">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.linearinterp!-Tuple{LinearInterpolators.SparseInterpolators.SparseInterpolator{var&quot;#s6&quot;, S, N} where {var&quot;#s6&quot;&lt;:AbstractFloat, S, N}, AbstractVector{var&quot;#s5&quot;} where var&quot;#s5&quot;&lt;:Number}" href="#SPECTrecon.linearinterp!-Tuple{LinearInterpolators.SparseInterpolators.SparseInterpolator{var&quot;#s6&quot;, S, N} where {var&quot;#s6&quot;&lt;:AbstractFloat, S, N}, AbstractVector{var&quot;#s5&quot;} where var&quot;#s5&quot;&lt;:Number}"><code>SPECTrecon.linearinterp!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">linearinterp!(A, x)</code></pre><p>Assign key values in <code>SparseInterpolator</code> (linear) <code>A</code> that are calculated from <code>x</code>. <code>x</code> must be a constant vector</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/e1593dccc16260d5c2baab8faae33c2f225e8c5f/src/rotate3.jl#L10-L14">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.mul3dj!-Tuple{AbstractArray{var&quot;#s17&quot;, 3} where var&quot;#s17&quot;, AbstractMatrix{T} where T, Int64}" href="#SPECTrecon.mul3dj!-Tuple{AbstractArray{var&quot;#s17&quot;, 3} where var&quot;#s17&quot;, AbstractMatrix{T} where T, Int64}"><code>SPECTrecon.mul3dj!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">mul3dj!(mat3d, mat2d, j)</code></pre><p>Non-allocating <code>mat3d[:,j,:] *= mat2d</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/e1593dccc16260d5c2baab8faae33c2f225e8c5f/src/helper.jl#L287-L290">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.pad2sizezero!-Union{Tuple{T}, Tuple{AbstractMatrix{T}, AbstractMatrix{T} where T, Tuple{Int64, Int64}}} where T" href="#SPECTrecon.pad2sizezero!-Union{Tuple{T}, Tuple{AbstractMatrix{T}, AbstractMatrix{T} where T, Tuple{Int64, Int64}}} where T"><code>SPECTrecon.pad2sizezero!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">pad2sizezero!(output, img, padsize)</code></pre><p>Non-allocating version of padding: `output[pad<em>dims[1]+1 : pad</em>dims[1]+dims[1],         pad<em>dims[2]+1 : pad</em>dims[2]+dims[2]]) .= img</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/e1593dccc16260d5c2baab8faae33c2f225e8c5f/src/helper.jl#L61-L67">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.pad_it!-Union{Tuple{T}, Tuple{D}, Tuple{AbstractArray{T, D}, Tuple{Vararg{Int64, D}}}} where {D, T&lt;:Number}" href="#SPECTrecon.pad_it!-Union{Tuple{T}, Tuple{D}, Tuple{AbstractArray{T, D}, Tuple{Vararg{Int64, D}}}} where {D, T&lt;:Number}"><code>SPECTrecon.pad_it!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">pad_it!(X, padsize)</code></pre><p>Zero-pad <code>X</code> to <code>padsize</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/e1593dccc16260d5c2baab8faae33c2f225e8c5f/src/helper.jl#L85-L88">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.padrepl!-Tuple{AbstractMatrix{T} where T, AbstractMatrix{T} where T, NTuple{4, Int64}}" href="#SPECTrecon.padrepl!-Tuple{AbstractMatrix{T} where T, AbstractMatrix{T} where T, NTuple{4, Int64}}"><code>SPECTrecon.padrepl!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">padrepl!(output, img, padsize)</code></pre><p>Pad with replication from <code>img</code> into <code>output</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/e1593dccc16260d5c2baab8faae33c2f225e8c5f/src/helper.jl#L40-L43">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.padzero!-Union{Tuple{T}, Tuple{AbstractMatrix{T}, AbstractMatrix{T} where T, NTuple{4, Int64}}} where T" href="#SPECTrecon.padzero!-Union{Tuple{T}, Tuple{AbstractMatrix{T}, AbstractMatrix{T} where T, NTuple{4, Int64}}} where T"><code>SPECTrecon.padzero!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">padzero!(output, img, pad_x, pad_y)</code></pre><p>Mutating version of padding a 2D image by filling zeros. Output has size <code>(size(img, 1) + padsize[1] + padsize[2], size(img, 2) + padsize[3] + padsize[4])</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/e1593dccc16260d5c2baab8faae33c2f225e8c5f/src/helper.jl#L17-L21">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.plus1di!-Tuple{AbstractMatrix{T} where T, AbstractVector{T} where T, Int64}" href="#SPECTrecon.plus1di!-Tuple{AbstractMatrix{T} where T, AbstractVector{T} where T, Int64}"><code>SPECTrecon.plus1di!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">plus1di!(mat2d, mat1d)</code></pre><p>Non-allocating <code>mat2d[i, :] += mat1d</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/e1593dccc16260d5c2baab8faae33c2f225e8c5f/src/helper.jl#L137-L140">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.plus1dj!-Tuple{AbstractMatrix{T} where T, AbstractVector{T} where T, Int64}" href="#SPECTrecon.plus1dj!-Tuple{AbstractMatrix{T} where T, AbstractVector{T} where T, Int64}"><code>SPECTrecon.plus1dj!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">plus1dj!(mat2d, mat1d)</code></pre><p>Non-allocating <code>mat2d[:, j] += mat1d</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/e1593dccc16260d5c2baab8faae33c2f225e8c5f/src/helper.jl#L156-L159">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.plus2di!-Tuple{AbstractVector{T} where T, AbstractMatrix{T} where T, Int64}" href="#SPECTrecon.plus2di!-Tuple{AbstractVector{T} where T, AbstractMatrix{T} where T, Int64}"><code>SPECTrecon.plus2di!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">plus2di!(mat1d, mat2d, i)</code></pre><p>Non-allocating <code>mat1d += mat2d[i,:]</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/e1593dccc16260d5c2baab8faae33c2f225e8c5f/src/helper.jl#L174-L177">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.plus2dj!-Tuple{AbstractVector{T} where T, AbstractMatrix{T} where T, Int64}" href="#SPECTrecon.plus2dj!-Tuple{AbstractVector{T} where T, AbstractMatrix{T} where T, Int64}"><code>SPECTrecon.plus2dj!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">plus2dj!(mat1d, mat2d, j)</code></pre><p>Non-allocating <code>mat1d += mat2d[:,j]</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/e1593dccc16260d5c2baab8faae33c2f225e8c5f/src/helper.jl#L192-L195">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.plus3di!-Tuple{AbstractMatrix{T} where T, AbstractArray{var&quot;#s17&quot;, 3} where var&quot;#s17&quot;, Int64}" href="#SPECTrecon.plus3di!-Tuple{AbstractMatrix{T} where T, AbstractArray{var&quot;#s17&quot;, 3} where var&quot;#s17&quot;, Int64}"><code>SPECTrecon.plus3di!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">plus3di!(mat2d, mat3d, i)</code></pre><p>Non-allocating <code>mat2d += mat3d[i,:,:]</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/e1593dccc16260d5c2baab8faae33c2f225e8c5f/src/helper.jl#L210-L213">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.plus3dj!-Tuple{AbstractMatrix{T} where T, AbstractArray{var&quot;#s17&quot;, 3} where var&quot;#s17&quot;, Int64}" href="#SPECTrecon.plus3dj!-Tuple{AbstractMatrix{T} where T, AbstractArray{var&quot;#s17&quot;, 3} where var&quot;#s17&quot;, Int64}"><code>SPECTrecon.plus3dj!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">plus3dj!(mat2d, mat3d, j)</code></pre><p>Non-allocating <code>mat2d += mat3d[:,j,:]</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/e1593dccc16260d5c2baab8faae33c2f225e8c5f/src/helper.jl#L229-L232">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.plus3dk!-Tuple{AbstractMatrix{T} where T, AbstractArray{var&quot;#s17&quot;, 3} where var&quot;#s17&quot;, Int64}" href="#SPECTrecon.plus3dk!-Tuple{AbstractMatrix{T} where T, AbstractArray{var&quot;#s17&quot;, 3} where var&quot;#s17&quot;, Int64}"><code>SPECTrecon.plus3dk!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">plus3dk!(mat2d, mat3d, k)</code></pre><p>Non-allocating <code>mat2d += mat3d[:,:,k]</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/e1593dccc16260d5c2baab8faae33c2f225e8c5f/src/helper.jl#L248-L251">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.project!-Tuple{AbstractArray{var&quot;#s49&quot;, 3} where var&quot;#s49&quot;&lt;:Number, AbstractArray{var&quot;#s30&quot;, 3} where var&quot;#s30&quot;&lt;:Number, SPECTplan, Vector{Workarray}}" href="#SPECTrecon.project!-Tuple{AbstractArray{var&quot;#s49&quot;, 3} where var&quot;#s49&quot;&lt;:Number, AbstractArray{var&quot;#s30&quot;, 3} where var&quot;#s30&quot;&lt;:Number, SPECTplan, Vector{Workarray}}"><code>SPECTrecon.project!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">project!(views, image, plan, workarray; index)</code></pre><p>Project <code>image</code> into multiple <code>views</code> with indexes <code>index</code> (defaults to <code>1:nview</code>). The 3D <code>views</code> array must be pre-allocated, but need not be initialized.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/e1593dccc16260d5c2baab8faae33c2f225e8c5f/src/project.jl#L106-L110">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.project!-Tuple{AbstractMatrix{var&quot;#s52&quot;} where var&quot;#s52&quot;&lt;:Number, AbstractArray{var&quot;#s51&quot;, 3} where var&quot;#s51&quot;&lt;:Number, SPECTplan, Vector{Workarray}, Int64}" href="#SPECTrecon.project!-Tuple{AbstractMatrix{var&quot;#s52&quot;} where var&quot;#s52&quot;&lt;:Number, AbstractArray{var&quot;#s51&quot;, 3} where var&quot;#s51&quot;&lt;:Number, SPECTplan, Vector{Workarray}, Int64}"><code>SPECTrecon.project!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">project!(view, plan, workarray, image, viewidx)</code></pre><p>SPECT projection of <code>image</code> into a single <code>view</code> with index <code>viewidx</code>. The <code>view</code> must be pre-allocated but need not be initialized to zero.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/e1593dccc16260d5c2baab8faae33c2f225e8c5f/src/project.jl#L5-L9">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.project-Tuple{AbstractArray{var&quot;#s49&quot;, 3} where var&quot;#s49&quot;&lt;:Number, AbstractArray{var&quot;#s30&quot;, 3} where var&quot;#s30&quot;&lt;:Number, AbstractArray{var&quot;#s19&quot;, 4} where var&quot;#s19&quot;&lt;:Number, Number}" href="#SPECTrecon.project-Tuple{AbstractArray{var&quot;#s49&quot;, 3} where var&quot;#s49&quot;&lt;:Number, AbstractArray{var&quot;#s30&quot;, 3} where var&quot;#s30&quot;&lt;:Number, AbstractArray{var&quot;#s19&quot;, 4} where var&quot;#s19&quot;&lt;:Number, Number}"><code>SPECTrecon.project</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">views = project(image, mumap, psfs, dy; interpidx, kwargs...)</code></pre><p>Convenience method for SPECT forward projector that does all allocation including initializing <code>plan</code> and <code>workarray</code>.</p><p>In</p><ul><li><code>image</code> : 3D array <code>[nx,ny,nz]</code></li><li><code>mumap</code> : <code>[nx,ny,nz]</code> 3D attenuation map, possibly zeros()</li><li><code>psfs</code> : 4D PSF array</li><li><code>dy::RealU</code> : pixel size</li></ul><p>Option</p><ul><li><code>interpidx</code> : 1 or 2</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/e1593dccc16260d5c2baab8faae33c2f225e8c5f/src/project.jl#L143-L155">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.project-Tuple{AbstractArray{var&quot;#s59&quot;, 3} where var&quot;#s59&quot;&lt;:Number, SPECTplan, Vector{Workarray}}" href="#SPECTrecon.project-Tuple{AbstractArray{var&quot;#s59&quot;, 3} where var&quot;#s59&quot;&lt;:Number, SPECTplan, Vector{Workarray}}"><code>SPECTrecon.project</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">views = project(image, plan, workarray ; kwargs...)</code></pre><p>Convenience method for SPECT forward projector that allocates and returns views.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/e1593dccc16260d5c2baab8faae33c2f225e8c5f/src/project.jl#L127-L130">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.rot180!-Tuple{AbstractMatrix{T} where T, AbstractMatrix{T} where T}" href="#SPECTrecon.rot180!-Tuple{AbstractMatrix{T} where T, AbstractMatrix{T} where T}"><code>SPECTrecon.rot180!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">rot180!(B::AbstractMatrix, A::AbstractMatrix)</code></pre><p>In place version of <code>rot180</code>, returning rotation of <code>A</code> in <code>B</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/e1593dccc16260d5c2baab8faae33c2f225e8c5f/src/rotate3.jl#L189-L192">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.rot_f90!-Tuple{AbstractMatrix{T} where T, AbstractMatrix{T} where T, Int64}" href="#SPECTrecon.rot_f90!-Tuple{AbstractMatrix{T} where T, AbstractMatrix{T} where T, Int64}"><code>SPECTrecon.rot_f90!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">rot_f90!(output, img, m)</code></pre><p>In-place version of rotating an image by 90/180/270 degrees</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/e1593dccc16260d5c2baab8faae33c2f225e8c5f/src/rotate3.jl#L203-L206">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.rot_f90_adj!-Tuple{AbstractMatrix{T} where T, AbstractMatrix{T} where T, Int64}" href="#SPECTrecon.rot_f90_adj!-Tuple{AbstractMatrix{T} where T, AbstractMatrix{T} where T, Int64}"><code>SPECTrecon.rot_f90_adj!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">rot_f90_adj!(output, img, m)
The adjoint of rotating an image by 90/180/270 degrees</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/e1593dccc16260d5c2baab8faae33c2f225e8c5f/src/rotate3.jl#L227-L230">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.rotate_x!-Tuple{AbstractMatrix{var&quot;#s4&quot;} where var&quot;#s4&quot;&lt;:Number, AbstractMatrix{var&quot;#s3&quot;} where var&quot;#s3&quot;&lt;:Number, Real, AbstractVector{var&quot;#s2&quot;} where var&quot;#s2&quot;&lt;:Number, AbstractVector{var&quot;#s49&quot;} where var&quot;#s49&quot;&lt;:Number, LinearInterpolators.SparseInterpolators.SparseInterpolator{var&quot;#s50&quot;, S, N} where {var&quot;#s50&quot;&lt;:AbstractFloat, S, N}, AbstractVector{var&quot;#s51&quot;} where var&quot;#s51&quot;&lt;:Number, Real}" href="#SPECTrecon.rotate_x!-Tuple{AbstractMatrix{var&quot;#s4&quot;} where var&quot;#s4&quot;&lt;:Number, AbstractMatrix{var&quot;#s3&quot;} where var&quot;#s3&quot;&lt;:Number, Real, AbstractVector{var&quot;#s2&quot;} where var&quot;#s2&quot;&lt;:Number, AbstractVector{var&quot;#s49&quot;} where var&quot;#s49&quot;&lt;:Number, LinearInterpolators.SparseInterpolators.SparseInterpolator{var&quot;#s50&quot;, S, N} where {var&quot;#s50&quot;&lt;:AbstractFloat, S, N}, AbstractVector{var&quot;#s51&quot;} where var&quot;#s51&quot;&lt;:Number, Real}"><code>SPECTrecon.rotate_x!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">rotate_x!(output, img, tan_θ, xi, yi, interp, workvec, c_y)</code></pre><p>Rotate a 2D image along x axis in clockwise direction using 1d linear interpolation, storing results in <code>output</code>. Sample locations <code>xi</code> and <code>yi</code> must be in increasing order.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/e1593dccc16260d5c2baab8faae33c2f225e8c5f/src/rotate3.jl#L45-L50">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.rotate_x_adj!-Tuple{AbstractMatrix{var&quot;#s19&quot;} where var&quot;#s19&quot;&lt;:Number, AbstractMatrix{var&quot;#s18&quot;} where var&quot;#s18&quot;&lt;:Number, Real, AbstractVector{var&quot;#s17&quot;} where var&quot;#s17&quot;&lt;:Number, AbstractVector{var&quot;#s11&quot;} where var&quot;#s11&quot;&lt;:Number, LinearInterpolators.SparseInterpolators.SparseInterpolator, AbstractVector{var&quot;#s6&quot;} where var&quot;#s6&quot;&lt;:Number, Real}" href="#SPECTrecon.rotate_x_adj!-Tuple{AbstractMatrix{var&quot;#s19&quot;} where var&quot;#s19&quot;&lt;:Number, AbstractMatrix{var&quot;#s18&quot;} where var&quot;#s18&quot;&lt;:Number, Real, AbstractVector{var&quot;#s17&quot;} where var&quot;#s17&quot;&lt;:Number, AbstractVector{var&quot;#s11&quot;} where var&quot;#s11&quot;&lt;:Number, LinearInterpolators.SparseInterpolators.SparseInterpolator, AbstractVector{var&quot;#s6&quot;} where var&quot;#s6&quot;&lt;:Number, Real}"><code>SPECTrecon.rotate_x_adj!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">rotate_x_adj!(output, img, tan_θ, xi, yi, interp, workvec, c_y)</code></pre><p>The adjoint of rotating a 2D image along x axis in clockwise direction using 1d linear interpolation, storing results in <code>output</code> xi and yi must be in increasing order.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/e1593dccc16260d5c2baab8faae33c2f225e8c5f/src/rotate3.jl#L74-L79">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.rotate_y!-Tuple{AbstractMatrix{var&quot;#s19&quot;} where var&quot;#s19&quot;&lt;:Number, AbstractMatrix{var&quot;#s18&quot;} where var&quot;#s18&quot;&lt;:Number, Real, AbstractVector{var&quot;#s17&quot;} where var&quot;#s17&quot;&lt;:Number, AbstractVector{var&quot;#s11&quot;} where var&quot;#s11&quot;&lt;:Number, LinearInterpolators.SparseInterpolators.SparseInterpolator, AbstractVector{var&quot;#s6&quot;} where var&quot;#s6&quot;&lt;:Number, Real}" href="#SPECTrecon.rotate_y!-Tuple{AbstractMatrix{var&quot;#s19&quot;} where var&quot;#s19&quot;&lt;:Number, AbstractMatrix{var&quot;#s18&quot;} where var&quot;#s18&quot;&lt;:Number, Real, AbstractVector{var&quot;#s17&quot;} where var&quot;#s17&quot;&lt;:Number, AbstractVector{var&quot;#s11&quot;} where var&quot;#s11&quot;&lt;:Number, LinearInterpolators.SparseInterpolators.SparseInterpolator, AbstractVector{var&quot;#s6&quot;} where var&quot;#s6&quot;&lt;:Number, Real}"><code>SPECTrecon.rotate_y!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">rotate_y!(output, img, sin_θ, xi, yi, interp, workvec, c_x)</code></pre><p>Rotate a 2D image along y axis in clockwise direction using 1d linear interpolation, storing results in <code>output</code> xi and yi must be in increasing order.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/e1593dccc16260d5c2baab8faae33c2f225e8c5f/src/rotate3.jl#L103-L108">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.rotate_y_adj!-Tuple{AbstractMatrix{var&quot;#s19&quot;} where var&quot;#s19&quot;&lt;:Number, AbstractMatrix{var&quot;#s18&quot;} where var&quot;#s18&quot;&lt;:Number, Real, AbstractVector{var&quot;#s17&quot;} where var&quot;#s17&quot;&lt;:Number, AbstractVector{var&quot;#s11&quot;} where var&quot;#s11&quot;&lt;:Number, LinearInterpolators.SparseInterpolators.SparseInterpolator, AbstractVector{var&quot;#s6&quot;} where var&quot;#s6&quot;&lt;:Number, Real}" href="#SPECTrecon.rotate_y_adj!-Tuple{AbstractMatrix{var&quot;#s19&quot;} where var&quot;#s19&quot;&lt;:Number, AbstractMatrix{var&quot;#s18&quot;} where var&quot;#s18&quot;&lt;:Number, Real, AbstractVector{var&quot;#s17&quot;} where var&quot;#s17&quot;&lt;:Number, AbstractVector{var&quot;#s11&quot;} where var&quot;#s11&quot;&lt;:Number, LinearInterpolators.SparseInterpolators.SparseInterpolator, AbstractVector{var&quot;#s6&quot;} where var&quot;#s6&quot;&lt;:Number, Real}"><code>SPECTrecon.rotate_y_adj!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">rotate_y_adj!(output, img, sin_θ, xi, yi, interp, workvec, c_x)</code></pre><p>Adjoint of rotating a 2D image along y axis in clockwise direction using 1d linear interpolation, storing results in <code>output</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/e1593dccc16260d5c2baab8faae33c2f225e8c5f/src/rotate3.jl#L132-L136">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.rotl90!-Tuple{AbstractMatrix{T} where T, AbstractMatrix{T} where T}" href="#SPECTrecon.rotl90!-Tuple{AbstractMatrix{T} where T, AbstractMatrix{T} where T}"><code>SPECTrecon.rotl90!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">rotl90!(B::AbstractMatrix, A::AbstractMatrix)</code></pre><p>In place version of <code>rotl90</code>, returning rotation of <code>A</code> in <code>B</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/e1593dccc16260d5c2baab8faae33c2f225e8c5f/src/rotate3.jl#L161-L164">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.rotr90!-Tuple{AbstractMatrix{T} where T, AbstractMatrix{T} where T}" href="#SPECTrecon.rotr90!-Tuple{AbstractMatrix{T} where T, AbstractMatrix{T} where T}"><code>SPECTrecon.rotr90!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">rotr90!(B::AbstractMatrix, A::AbstractMatrix)</code></pre><p>In place version of <code>rotr90</code>, returning rotation of <code>A</code> in <code>B</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/e1593dccc16260d5c2baab8faae33c2f225e8c5f/src/rotate3.jl#L175-L178">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.scale3dj!-Tuple{AbstractMatrix{T} where T, AbstractArray{var&quot;#s17&quot;, 3} where var&quot;#s17&quot;, Int64, Number}" href="#SPECTrecon.scale3dj!-Tuple{AbstractMatrix{T} where T, AbstractArray{var&quot;#s17&quot;, 3} where var&quot;#s17&quot;, Int64, Number}"><code>SPECTrecon.scale3dj!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">scale3dj!(mat2d, mat3d, j, s)</code></pre><p>Non-allocating <code>mat2d = s * mat3d[:,j,:]</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/e1593dccc16260d5c2baab8faae33c2f225e8c5f/src/helper.jl#L267-L270">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Home</a><a class="docs-footer-nextpage" href="../examples/1-overview/">SPECTrecon overview »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.7 on <span class="colophon-date" title="Wednesday 6 October 2021 17:33">Wednesday 6 October 2021</span>. Using Julia version 1.6.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
