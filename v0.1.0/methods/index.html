<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Methods · SPECTrecon.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link rel="canonical" href="https://JeffFessler.github.io/SPECTrecon.jl/stable/methods/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.044/juliamono.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/custom.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">SPECTrecon.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li class="is-active"><a class="tocitem" href>Methods</a><ul class="internal"><li><a class="tocitem" href="#Methods-list"><span>Methods list</span></a></li><li><a class="tocitem" href="#Methods-usage"><span>Methods usage</span></a></li></ul></li><li><a class="tocitem" href="../history/">History</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../generated/examples/1-overview/">SPECTrecon overview</a></li><li><a class="tocitem" href="../generated/examples/2-rotate/">SPECTrecon rotation</a></li><li><a class="tocitem" href="../generated/examples/3-psf/">SPECTrecon PSF</a></li><li><a class="tocitem" href="../generated/examples/4-mlem/">SPECTrecon ML-EM</a></li><li><a class="tocitem" href="../generated/examples/5-2d/">SPECTrecon 2D use</a></li><li><a class="tocitem" href="../generated/examples/6-dl/">SPECTrecon deep learning use</a></li><li><a class="tocitem" href="../generated/examples/7-osem/">SPECTrecon OS-EM</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Methods</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Methods</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/main/docs/src/methods.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h2 id="Methods-list"><a class="docs-heading-anchor" href="#Methods-list">Methods list</a><a id="Methods-list-1"></a><a class="docs-heading-anchor-permalink" href="#Methods-list" title="Permalink"></a></h2><ul><li><a href="#SPECTrecon.SPECTrecon"><code>SPECTrecon.SPECTrecon</code></a></li><li><a href="#SPECTrecon.Rotate1D"><code>SPECTrecon.Rotate1D</code></a></li><li><a href="#SPECTrecon.Rotate2D"><code>SPECTrecon.Rotate2D</code></a></li><li><a href="#SPECTrecon.PlanPSF"><code>SPECTrecon.PlanPSF</code></a></li><li><a href="#SPECTrecon.PlanRotate"><code>SPECTrecon.PlanRotate</code></a></li><li><a href="#SPECTrecon.RotateMode"><code>SPECTrecon.RotateMode</code></a></li><li><a href="#SPECTrecon.SPECTplan"><code>SPECTrecon.SPECTplan</code></a></li><li><a href="#Base.show-Union{Tuple{R}, Tuple{T}, Tuple{IO, MIME{Symbol(&quot;text/plain&quot;)}, PlanRotate{T, R}}} where {T, R}"><code>Base.show</code></a></li><li><a href="#Base.show-Union{Tuple{T}, Tuple{IO, MIME{Symbol(&quot;text/plain&quot;)}, SPECTplan{T}}} where T"><code>Base.show</code></a></li><li><a href="#Base.show-Tuple{IO, MIME{Symbol(&quot;text/plain&quot;)}, Vector{&lt;:PlanPSF}}"><code>Base.show</code></a></li><li><a href="#Base.show-Union{Tuple{T}, Tuple{IO, MIME{Symbol(&quot;text/plain&quot;)}, PlanPSF{T}}} where T"><code>Base.show</code></a></li><li><a href="#Base.show-Union{Tuple{R}, Tuple{T}, Tuple{IO, MIME{Symbol(&quot;text/plain&quot;)}, Array{PlanRotate{T, R}, 1}}} where {T, R}"><code>Base.show</code></a></li><li><a href="#Base.sizeof-Tuple{T} where T&lt;:Union{PlanRotate, LinearInterpolators.SparseInterpolators.SparseInterpolator}"><code>Base.sizeof</code></a></li><li><a href="#Base.sizeof-Tuple{T} where T&lt;:PlanPSF"><code>Base.sizeof</code></a></li><li><a href="#Base.sizeof-Tuple{T} where T&lt;:SPECTplan"><code>Base.sizeof</code></a></li><li><a href="#SPECTrecon.Ablock-Tuple{SPECTplan, Int64}"><code>SPECTrecon.Ablock</code></a></li><li><a href="#SPECTrecon.backproject-Tuple{AbstractArray{&lt;:Number, 3}, AbstractArray{&lt;:Number, 3}, AbstractArray{&lt;:Number, 4}, Number}"><code>SPECTrecon.backproject</code></a></li><li><a href="#SPECTrecon.backproject-Tuple{AbstractArray{&lt;:Number, 3}, SPECTplan}"><code>SPECTrecon.backproject</code></a></li><li><a href="#SPECTrecon.backproject!-Tuple{AbstractArray{&lt;:Number, 3}, AbstractMatrix{&lt;:Number}, SPECTplan, Int64}"><code>SPECTrecon.backproject!</code></a></li><li><a href="#SPECTrecon.backproject!-Tuple{AbstractArray{&lt;:Number, 3}, AbstractArray{&lt;:Number, 3}, SPECTplan}"><code>SPECTrecon.backproject!</code></a></li><li><a href="#SPECTrecon.backproject!-Tuple{AbstractArray{&lt;:Number, 3}, AbstractMatrix{&lt;:Number}, SPECTplan, Int64, Int64}"><code>SPECTrecon.backproject!</code></a></li><li><a href="#SPECTrecon.copy3dj!-Tuple{AbstractMatrix, AbstractArray{&lt;:Any, 3}, Int64}"><code>SPECTrecon.copy3dj!</code></a></li><li><a href="#SPECTrecon.fft_conv-Union{Tuple{K}, Tuple{I}, Tuple{AbstractMatrix{I}, AbstractMatrix{K}}} where {I&lt;:Number, K&lt;:Number}"><code>SPECTrecon.fft_conv</code></a></li><li><a href="#SPECTrecon.fft_conv!-Tuple{AbstractArray{&lt;:Number, 3}, AbstractArray{&lt;:Number, 3}, AbstractArray{&lt;:Number, 3}, Vector{&lt;:PlanPSF}}"><code>SPECTrecon.fft_conv!</code></a></li><li><a href="#SPECTrecon.fft_conv!-Tuple{AbstractMatrix{&lt;:Number}, AbstractMatrix{&lt;:Number}, AbstractMatrix{&lt;:Number}, PlanPSF}"><code>SPECTrecon.fft_conv!</code></a></li><li><a href="#SPECTrecon.fft_conv_adj-Union{Tuple{K}, Tuple{I}, Tuple{AbstractMatrix{I}, AbstractMatrix{K}}} where {I&lt;:Number, K&lt;:Number}"><code>SPECTrecon.fft_conv_adj</code></a></li><li><a href="#SPECTrecon.fft_conv_adj!-Union{Tuple{T}, Tuple{AbstractMatrix{&lt;:Number}, AbstractMatrix{&lt;:Number}, AbstractMatrix{&lt;:Number}, PlanPSF{T}}} where T"><code>SPECTrecon.fft_conv_adj!</code></a></li><li><a href="#SPECTrecon.fft_conv_adj!-Tuple{AbstractArray{&lt;:Number, 3}, AbstractArray{&lt;:Number, 3}, AbstractArray{&lt;:Number, 3}, Vector{&lt;:PlanPSF}}"><code>SPECTrecon.fft_conv_adj!</code></a></li><li><a href="#SPECTrecon.fft_conv_adj2!-Tuple{AbstractArray{&lt;:Number, 3}, AbstractMatrix{&lt;:Number}, AbstractArray{&lt;:Number, 3}, Vector{&lt;:PlanPSF}}"><code>SPECTrecon.fft_conv_adj2!</code></a></li><li><a href="#SPECTrecon.fftshift2!-Tuple{AbstractMatrix, AbstractMatrix}"><code>SPECTrecon.fftshift2!</code></a></li><li><a href="#SPECTrecon.foreach_setup-Tuple{Any}"><code>SPECTrecon.foreach_setup</code></a></li><li><a href="#SPECTrecon.imfilterz!-Tuple{PlanPSF}"><code>SPECTrecon.imfilterz!</code></a></li><li><a href="#SPECTrecon.imrotate-Union{Tuple{I}, Tuple{AbstractMatrix{I}, Number}} where I&lt;:Number"><code>SPECTrecon.imrotate</code></a></li><li><a href="#SPECTrecon.imrotate!-Tuple{AbstractArray{&lt;:Number, 3}, AbstractArray{&lt;:Number, 3}, Number, Vector{&lt;:PlanRotate}, Symbol}"><code>SPECTrecon.imrotate!</code></a></li><li><a href="#SPECTrecon.imrotate!"><code>SPECTrecon.imrotate!</code></a></li><li><a href="#SPECTrecon.imrotate!-Tuple{AbstractMatrix{&lt;:Number}, AbstractMatrix{&lt;:Number}, Number, PlanRotate{&lt;:Number, RotateMode{:one}}}"><code>SPECTrecon.imrotate!</code></a></li><li><a href="#SPECTrecon.imrotate!-Union{Tuple{T}, Tuple{AbstractMatrix{&lt;:Number}, AbstractMatrix{&lt;:Number}, Number, PlanRotate{T, RotateMode{:two}}}} where T"><code>SPECTrecon.imrotate!</code></a></li><li><a href="#SPECTrecon.imrotate_adj-Union{Tuple{I}, Tuple{AbstractMatrix{I}, Number}} where I&lt;:Number"><code>SPECTrecon.imrotate_adj</code></a></li><li><a href="#SPECTrecon.imrotate_adj!-Tuple{AbstractArray{&lt;:Number, 3}, AbstractArray{&lt;:Number, 3}, Number, Vector{&lt;:PlanRotate}, Symbol}"><code>SPECTrecon.imrotate_adj!</code></a></li><li><a href="#SPECTrecon.imrotate_adj!-Tuple{AbstractMatrix{&lt;:Number}, AbstractMatrix{&lt;:Number}, Number, PlanRotate{&lt;:Number, RotateMode{:one}}}"><code>SPECTrecon.imrotate_adj!</code></a></li><li><a href="#SPECTrecon.imrotate_adj!-Union{Tuple{T}, Tuple{AbstractMatrix{&lt;:Number}, AbstractMatrix{&lt;:Number}, Number, PlanRotate{T, RotateMode{:two}}}} where T"><code>SPECTrecon.imrotate_adj!</code></a></li><li><a href="#SPECTrecon.imrotate_adj!"><code>SPECTrecon.imrotate_adj!</code></a></li><li><a href="#SPECTrecon.linearinterp!-Tuple{LinearInterpolators.SparseInterpolators.SparseInterpolator, Number, Number, Int64}"><code>SPECTrecon.linearinterp!</code></a></li><li><a href="#SPECTrecon.mlem-Tuple{AbstractArray, Vararg{Any}}"><code>SPECTrecon.mlem</code></a></li><li><a href="#SPECTrecon.mlem!-Tuple{AbstractArray, AbstractArray, AbstractArray, AbstractArray, Union{AbstractArray, LinearMapsAA.LinearMapAO}}"><code>SPECTrecon.mlem!</code></a></li><li><a href="#SPECTrecon.mul3dj!-Tuple{AbstractArray{&lt;:Any, 3}, AbstractMatrix, Int64}"><code>SPECTrecon.mul3dj!</code></a></li><li><a href="#SPECTrecon.osem-Tuple{AbstractArray, Vararg{Any}}"><code>SPECTrecon.osem</code></a></li><li><a href="#SPECTrecon.osem!-Tuple{AbstractArray, AbstractArray, AbstractArray, AbstractArray, Union{Vector{AbstractArray}, Vector{LinearMapsAA.LinearMapAO}}}"><code>SPECTrecon.osem!</code></a></li><li><a href="#SPECTrecon.pad2sizezero!-Union{Tuple{T}, Tuple{AbstractMatrix{T}, AbstractMatrix, Tuple{Int64, Int64}}} where T"><code>SPECTrecon.pad2sizezero!</code></a></li><li><a href="#SPECTrecon.pad_it!-Union{Tuple{T}, Tuple{D}, Tuple{AbstractArray{T, D}, Tuple{Vararg{Int64, D}}}} where {D, T&lt;:Number}"><code>SPECTrecon.pad_it!</code></a></li><li><a href="#SPECTrecon.padrepl!-Tuple{AbstractMatrix, AbstractMatrix, NTuple{4, Int64}}"><code>SPECTrecon.padrepl!</code></a></li><li><a href="#SPECTrecon.padzero!-Union{Tuple{T}, Tuple{AbstractMatrix{T}, AbstractMatrix, NTuple{4, Int64}}} where T"><code>SPECTrecon.padzero!</code></a></li><li><a href="#SPECTrecon.plan_psf-Tuple{}"><code>SPECTrecon.plan_psf</code></a></li><li><a href="#SPECTrecon.plan_rotate-Tuple{Int64}"><code>SPECTrecon.plan_rotate</code></a></li><li><a href="#SPECTrecon.plus1di!-Tuple{AbstractMatrix, AbstractVector, Int64}"><code>SPECTrecon.plus1di!</code></a></li><li><a href="#SPECTrecon.plus1dj!-Tuple{AbstractMatrix, AbstractVector, Int64}"><code>SPECTrecon.plus1dj!</code></a></li><li><a href="#SPECTrecon.plus2di!-Tuple{AbstractVector, AbstractMatrix, Int64}"><code>SPECTrecon.plus2di!</code></a></li><li><a href="#SPECTrecon.plus2dj!-Tuple{AbstractVector, AbstractMatrix, Int64}"><code>SPECTrecon.plus2dj!</code></a></li><li><a href="#SPECTrecon.plus3di!-Tuple{AbstractMatrix, AbstractArray{&lt;:Any, 3}, Int64}"><code>SPECTrecon.plus3di!</code></a></li><li><a href="#SPECTrecon.plus3dj!-Tuple{AbstractMatrix, AbstractArray{&lt;:Any, 3}, Int64}"><code>SPECTrecon.plus3dj!</code></a></li><li><a href="#SPECTrecon.plus3dk!-Tuple{AbstractMatrix, AbstractArray{&lt;:Any, 3}, Int64}"><code>SPECTrecon.plus3dk!</code></a></li><li><a href="#SPECTrecon.project-Tuple{AbstractArray{&lt;:Number, 3}, AbstractArray{&lt;:Number, 3}, AbstractArray{&lt;:Number, 4}, Number}"><code>SPECTrecon.project</code></a></li><li><a href="#SPECTrecon.project-Tuple{AbstractArray{&lt;:Number, 3}, SPECTplan}"><code>SPECTrecon.project</code></a></li><li><a href="#SPECTrecon.project!-Tuple{AbstractMatrix{&lt;:Number}, AbstractArray{&lt;:Number, 3}, SPECTplan, Int64}"><code>SPECTrecon.project!</code></a></li><li><a href="#SPECTrecon.project!-Tuple{AbstractArray{&lt;:Number, 3}, AbstractArray{&lt;:Number, 3}, SPECTplan}"><code>SPECTrecon.project!</code></a></li><li><a href="#SPECTrecon.project!-Tuple{AbstractMatrix{&lt;:Number}, AbstractArray{&lt;:Number, 3}, SPECTplan, Int64, Int64}"><code>SPECTrecon.project!</code></a></li><li><a href="#SPECTrecon.psf_gauss-Tuple{}"><code>SPECTrecon.psf_gauss</code></a></li><li><a href="#SPECTrecon.rot180!-Tuple{AbstractMatrix, AbstractMatrix}"><code>SPECTrecon.rot180!</code></a></li><li><a href="#SPECTrecon.rot_f90!-Tuple{AbstractMatrix, AbstractMatrix, Int64}"><code>SPECTrecon.rot_f90!</code></a></li><li><a href="#SPECTrecon.rot_f90_adj!-Tuple{AbstractMatrix, AbstractMatrix, Int64}"><code>SPECTrecon.rot_f90_adj!</code></a></li><li><a href="#SPECTrecon.rotate_x!-Tuple{AbstractMatrix{&lt;:Number}, AbstractMatrix{&lt;:Number}, Number, LinearInterpolators.SparseInterpolators.SparseInterpolator}"><code>SPECTrecon.rotate_x!</code></a></li><li><a href="#SPECTrecon.rotate_x_adj!-Tuple{AbstractMatrix{&lt;:Number}, AbstractMatrix{&lt;:Number}, Number, LinearInterpolators.SparseInterpolators.SparseInterpolator}"><code>SPECTrecon.rotate_x_adj!</code></a></li><li><a href="#SPECTrecon.rotate_y!-Tuple{AbstractMatrix{&lt;:Number}, AbstractMatrix{&lt;:Number}, Number, LinearInterpolators.SparseInterpolators.SparseInterpolator}"><code>SPECTrecon.rotate_y!</code></a></li><li><a href="#SPECTrecon.rotate_y_adj!-Tuple{AbstractMatrix{&lt;:Number}, AbstractMatrix{&lt;:Number}, Number, LinearInterpolators.SparseInterpolators.SparseInterpolator}"><code>SPECTrecon.rotate_y_adj!</code></a></li><li><a href="#SPECTrecon.rotl90!-Tuple{AbstractMatrix, AbstractMatrix}"><code>SPECTrecon.rotl90!</code></a></li><li><a href="#SPECTrecon.rotr90!-Tuple{AbstractMatrix, AbstractMatrix}"><code>SPECTrecon.rotr90!</code></a></li><li><a href="#SPECTrecon.scale3dj!-Tuple{AbstractMatrix, AbstractArray{&lt;:Any, 3}, Int64, Number}"><code>SPECTrecon.scale3dj!</code></a></li></ul><h2 id="Methods-usage"><a class="docs-heading-anchor" href="#Methods-usage">Methods usage</a><a id="Methods-usage-1"></a><a class="docs-heading-anchor-permalink" href="#Methods-usage" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.SPECTrecon" href="#SPECTrecon.SPECTrecon"><code>SPECTrecon.SPECTrecon</code></a> — <span class="docstring-category">Module</span></header><section><div><pre><code class="language-julia hljs">SPECTrecon</code></pre><p>System matrix (forward and back-projector) for SPECT image reconstruction.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/42158f34d621d4d51fdf6421c2c0e7dfc0a3d34f/src/SPECTrecon.jl#L1-L4">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.Rotate1D" href="#SPECTrecon.Rotate1D"><code>SPECTrecon.Rotate1D</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia hljs">Rotate1D = RotateMode{:one}()</code></pre><p>Rotate using 3-pass 1D interpolation</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/42158f34d621d4d51fdf6421c2c0e7dfc0a3d34f/src/plan-rotate.jl#L15-L18">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.Rotate2D" href="#SPECTrecon.Rotate2D"><code>SPECTrecon.Rotate2D</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia hljs">Rotate2D = RotateMode{:two}()</code></pre><p>Rotate using 1-pass 2D bilinear interpolation</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/42158f34d621d4d51fdf6421c2c0e7dfc0a3d34f/src/plan-rotate.jl#L21-L24">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.PlanPSF" href="#SPECTrecon.PlanPSF"><code>SPECTrecon.PlanPSF</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">PlanPSF{T,Tf,Ti}( ; nx::Int, nz::Int, px::Int, pz::Int, T::DataType)</code></pre><p>Struct for storing work arrays and factors for 2D convolution for one thread. Each PSF is <code>px × pz</code></p><ul><li><code>T</code> datatype of work arrays (subtype of <code>AbstractFloat</code>)</li><li><code>nx::Int = 128</code> (<code>ny</code> implicitly the same)</li><li><code>nz::Int = nx</code> image size is <code>[nx,nx,nz]</code></li><li><code>px::Int = 1</code></li><li><code>pz::Int = px</code> (PSF size)</li><li><code>padsize::Tuple</code> : <code>(padup, paddown, padleft, padright)</code></li><li><code>workmat [nx+padup+paddown, nz+padleft+padright]</code> 2D padded image for FFT convolution</li><li><code>workvecx [nx+padup+paddown,]</code>: 1D work vector</li><li><code>workvecz [nz+padleft+padright,]</code>: 1D work vector</li><li><code>img_compl [nx+padup+paddown, nz+padleft+padright]</code>: 2D [complex] padded image for FFT</li><li><code>ker_compl [nx+padup+paddown, nz+padleft+padright]</code>: 2D [complex] padded image for FFT</li><li><code>fft_plan::Tf</code> plan for doing FFT; see <code>plan_fft!</code></li><li><code>ifft_plan::Ti</code> plan for doing IFFT; see <code>plan_ifft!</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/42158f34d621d4d51fdf6421c2c0e7dfc0a3d34f/src/plan-psf.jl#L7-L24">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.PlanRotate" href="#SPECTrecon.PlanRotate"><code>SPECTrecon.PlanRotate</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">PlanRotate{T, R}</code></pre><p>Struct for storing work arrays and factors for 2D square image rotation for one thread</p><ul><li><code>T</code> datatype of work arrays (default <code>Float32</code>)</li><li><code>R::RotateMode</code></li><li><code>nx::Int</code> image size</li><li><code>padsize::Int</code> : pad each side of image by this much</li><li><code>workmat1 [nx + 2 * padsize, nx + 2 * padsize]</code> padded work matrix</li><li><code>workmat2 [nx + 2 * padsize, nx + 2 * padsize]</code> padded work matrix</li><li><code>interp::SparseInterpolator{T, 2, 1}</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/42158f34d621d4d51fdf6421c2c0e7dfc0a3d34f/src/plan-rotate.jl#L28-L38">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.RotateMode" href="#SPECTrecon.RotateMode"><code>SPECTrecon.RotateMode</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">RotateMode</code></pre><p>Type to control image rotation method.</p><ul><li><code>Rotate1D</code> : 3-pass 1D interpolation</li><li><code>Rotate2D</code> : 1-pass 2D bilinear interpolation</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/42158f34d621d4d51fdf6421c2c0e7dfc0a3d34f/src/plan-rotate.jl#L7-L12">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.SPECTplan" href="#SPECTrecon.SPECTplan"><code>SPECTrecon.SPECTplan</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">SPECTplan</code></pre><p>Struct for storing key factors for a SPECT system model</p><ul><li><code>T</code> datatype of work arrays</li><li><code>imgsize</code> size of image</li><li><code>px,pz</code> psf dimension</li><li><code>imgr [nx, ny, nz]</code> 3D rotated version of image</li><li><code>add_img [nx, ny, nz]</code> 3D image for adding views and backprojection</li><li><code>mumap [nx,ny,nz]</code> attenuation map, must be 3D, possibly zeros()</li><li><code>mumapr [nx, ny, nz]</code> 3D rotated mumap</li><li><code>exp_mumapr [nx, nz]</code> 2D exponential rotated mumap</li><li><code>psfs [px,pz,ny,nview]</code> point spread function, must be 4D, with <code>px and</code>pz` odd, and symmetric for each slice</li><li><code>nview</code> number of views, must be integer</li><li><code>viewangle</code> set of view angles, must be from 0 to 2π</li><li><code>interpmeth</code> interpolation method, :one means 1d, :two means 2d</li><li><code>mode</code> pre-allcoation method, :fast means faster, :mem means use less memory</li><li><code>dy</code> voxel size in y direction (dx is the same value)</li><li><code>nthread</code> number of CPU threads used to process data, must be integer</li><li><code>planrot</code> Vector of struct <code>PlanRotate</code></li><li><code>planpsf</code> Vector of struct <code>PlanPSF</code></li></ul><p>Currently code assumes the following:</p><ul><li>each of the <code>nview</code> projection views is <code>[nx,nz]</code></li><li><code>nx = ny</code></li><li>uniform angular sampling</li><li><code>psf</code> is symmetric</li><li>multiprocessing using # of threads specified by <code>Threads.nthreads()</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/42158f34d621d4d51fdf6421c2c0e7dfc0a3d34f/src/spectplan.jl#L5-L31">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Base.show-Tuple{IO, MIME{Symbol(&quot;text/plain&quot;)}, Vector{&lt;:PlanPSF}}" href="#Base.show-Tuple{IO, MIME{Symbol(&quot;text/plain&quot;)}, Vector{&lt;:PlanPSF}}"><code>Base.show</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">show(io::IO, mime::MIME&quot;text/plain&quot;, vp::Vector{&lt;:PlanPSF})</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/42158f34d621d4d51fdf6421c2c0e7dfc0a3d34f/src/plan-psf.jl#L130-L132">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Base.show-Union{Tuple{R}, Tuple{T}, Tuple{IO, MIME{Symbol(&quot;text/plain&quot;)}, Array{PlanRotate{T, R}, 1}}} where {T, R}" href="#Base.show-Union{Tuple{R}, Tuple{T}, Tuple{IO, MIME{Symbol(&quot;text/plain&quot;)}, Array{PlanRotate{T, R}, 1}}} where {T, R}"><code>Base.show</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">show(io::IO, mime::MIME&quot;text/plain&quot;, vp::Vector{&lt;:PlanRotate})</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/42158f34d621d4d51fdf6421c2c0e7dfc0a3d34f/src/plan-rotate.jl#L125-L127">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Base.show-Union{Tuple{R}, Tuple{T}, Tuple{IO, MIME{Symbol(&quot;text/plain&quot;)}, PlanRotate{T, R}}} where {T, R}" href="#Base.show-Union{Tuple{R}, Tuple{T}, Tuple{IO, MIME{Symbol(&quot;text/plain&quot;)}, PlanRotate{T, R}}} where {T, R}"><code>Base.show</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">show(io::IO, ::MIME&quot;text/plain&quot;, plan::PlanRotate)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/42158f34d621d4d51fdf6421c2c0e7dfc0a3d34f/src/plan-rotate.jl#L106-L108">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Base.show-Union{Tuple{T}, Tuple{IO, MIME{Symbol(&quot;text/plain&quot;)}, PlanPSF{T}}} where T" href="#Base.show-Union{Tuple{T}, Tuple{IO, MIME{Symbol(&quot;text/plain&quot;)}, PlanPSF{T}}} where T"><code>Base.show</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">show(io::IO, ::MIME&quot;text/plain&quot;, plan::PlanPSF)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/42158f34d621d4d51fdf6421c2c0e7dfc0a3d34f/src/plan-psf.jl#L111-L113">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Base.show-Union{Tuple{T}, Tuple{IO, MIME{Symbol(&quot;text/plain&quot;)}, SPECTplan{T}}} where T" href="#Base.show-Union{Tuple{T}, Tuple{IO, MIME{Symbol(&quot;text/plain&quot;)}, SPECTplan{T}}} where T"><code>Base.show</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">show(io::IO, ::MIME&quot;text/plain&quot;, plan::SPECTplan)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/42158f34d621d4d51fdf6421c2c0e7dfc0a3d34f/src/spectplan.jl#L137-L139">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Base.sizeof-Tuple{T} where T&lt;:PlanPSF" href="#Base.sizeof-Tuple{T} where T&lt;:PlanPSF"><code>Base.sizeof</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">sizeof(::PlanPSF)</code></pre><p>Show size in bytes of <code>PlanPSF</code> object.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/42158f34d621d4d51fdf6421c2c0e7dfc0a3d34f/src/plan-psf.jl#L140-L143">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Base.sizeof-Tuple{T} where T&lt;:SPECTplan" href="#Base.sizeof-Tuple{T} where T&lt;:SPECTplan"><code>Base.sizeof</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">sizeof(::SPECTplan)</code></pre><p>Show size in bytes of <code>SPECTplan</code> object.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/42158f34d621d4d51fdf6421c2c0e7dfc0a3d34f/src/spectplan.jl#L156-L159">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Base.sizeof-Tuple{T} where T&lt;:Union{PlanRotate, LinearInterpolators.SparseInterpolators.SparseInterpolator}" href="#Base.sizeof-Tuple{T} where T&lt;:Union{PlanRotate, LinearInterpolators.SparseInterpolators.SparseInterpolator}"><code>Base.sizeof</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">sizeof(::PlanRotate)</code></pre><p>Show size in bytes of <code>PlanRotate</code> object.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/42158f34d621d4d51fdf6421c2c0e7dfc0a3d34f/src/plan-rotate.jl#L135-L138">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.Ablock-Tuple{SPECTplan, Int64}" href="#SPECTrecon.Ablock-Tuple{SPECTplan, Int64}"><code>SPECTrecon.Ablock</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Ablock(plan, nblocks)</code></pre><p>Generate a vector of linear maps for OSEM. -<code>plan</code>: SPECTrecon plan -<code>nblocks</code>: Number of blocks in OSEM</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/42158f34d621d4d51fdf6421c2c0e7dfc0a3d34f/src/ml-os-em.jl#L62-L67">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.backproject!-Tuple{AbstractArray{&lt;:Number, 3}, AbstractArray{&lt;:Number, 3}, SPECTplan}" href="#SPECTrecon.backproject!-Tuple{AbstractArray{&lt;:Number, 3}, AbstractArray{&lt;:Number, 3}, SPECTplan}"><code>SPECTrecon.backproject!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">backproject!(image, views, plan ; index)</code></pre><p>Backproject multiple views into <code>image</code>. Array <code>image</code> is not initialized to zero; caller must do that.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/42158f34d621d4d51fdf6421c2c0e7dfc0a3d34f/src/backproject.jl#L126-L130">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.backproject!-Tuple{AbstractArray{&lt;:Number, 3}, AbstractMatrix{&lt;:Number}, SPECTplan, Int64, Int64}" href="#SPECTrecon.backproject!-Tuple{AbstractArray{&lt;:Number, 3}, AbstractMatrix{&lt;:Number}, SPECTplan, Int64, Int64}"><code>SPECTrecon.backproject!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">backproject!(image, view, plan, thid, viewidx)</code></pre><p>Backproject a single view.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/42158f34d621d4d51fdf6421c2c0e7dfc0a3d34f/src/backproject.jl#L65-L68">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.backproject!-Tuple{AbstractArray{&lt;:Number, 3}, AbstractMatrix{&lt;:Number}, SPECTplan, Int64}" href="#SPECTrecon.backproject!-Tuple{AbstractArray{&lt;:Number, 3}, AbstractMatrix{&lt;:Number}, SPECTplan, Int64}"><code>SPECTrecon.backproject!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">backproject!(image, view, plan, viewidx)</code></pre><p>Backproject a single view.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/42158f34d621d4d51fdf6421c2c0e7dfc0a3d34f/src/backproject.jl#L5-L8">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.backproject-Tuple{AbstractArray{&lt;:Number, 3}, AbstractArray{&lt;:Number, 3}, AbstractArray{&lt;:Number, 4}, Number}" href="#SPECTrecon.backproject-Tuple{AbstractArray{&lt;:Number, 3}, AbstractArray{&lt;:Number, 3}, AbstractArray{&lt;:Number, 4}, Number}"><code>SPECTrecon.backproject</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">image = backproject(views, mumap, psfs, dy; interpmeth, kwargs...)</code></pre><p>SPECT backproject <code>views</code> using attenuation map <code>mumap</code> and PSF array <code>psfs</code> for pixel size <code>dy</code>. This method initializes the <code>plan</code> as a convenience. Most users should use <code>backproject!</code> instead after initializing those, for better efficiency.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/42158f34d621d4d51fdf6421c2c0e7dfc0a3d34f/src/backproject.jl#L177-L182">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.backproject-Tuple{AbstractArray{&lt;:Number, 3}, SPECTplan}" href="#SPECTrecon.backproject-Tuple{AbstractArray{&lt;:Number, 3}, SPECTplan}"><code>SPECTrecon.backproject</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">image = backproject(views, plan ; kwargs...)</code></pre><p>SPECT backproject <code>views</code>; this allocates the returned 3D array.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/42158f34d621d4d51fdf6421c2c0e7dfc0a3d34f/src/backproject.jl#L162-L165">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.copy3dj!-Tuple{AbstractMatrix, AbstractArray{&lt;:Any, 3}, Int64}" href="#SPECTrecon.copy3dj!-Tuple{AbstractMatrix, AbstractArray{&lt;:Any, 3}, Int64}"><code>SPECTrecon.copy3dj!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">copy3dj!(mat2d, mat3d, j)</code></pre><p>Non-allocating <code>mat2d .= mat3d[:,j,:]</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/42158f34d621d4d51fdf6421c2c0e7dfc0a3d34f/src/helper.jl#L317-L320">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.fft_conv!-Tuple{AbstractArray{&lt;:Number, 3}, AbstractArray{&lt;:Number, 3}, AbstractArray{&lt;:Number, 3}, Vector{&lt;:PlanPSF}}" href="#SPECTrecon.fft_conv!-Tuple{AbstractArray{&lt;:Number, 3}, AbstractArray{&lt;:Number, 3}, AbstractArray{&lt;:Number, 3}, Vector{&lt;:PlanPSF}}"><code>SPECTrecon.fft_conv!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">fft_conv!(output, image3, ker3, plans)</code></pre><p>Mutating version of convolving a 3D <code>image3</code> with a set of 2D symmetric kernels stored in 3D array <code>ker3</code> using <code>foreach</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/42158f34d621d4d51fdf6421c2c0e7dfc0a3d34f/src/fft_convolve.jl#L148-L154">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.fft_conv!-Tuple{AbstractMatrix{&lt;:Number}, AbstractMatrix{&lt;:Number}, AbstractMatrix{&lt;:Number}, PlanPSF}" href="#SPECTrecon.fft_conv!-Tuple{AbstractMatrix{&lt;:Number}, AbstractMatrix{&lt;:Number}, AbstractMatrix{&lt;:Number}, PlanPSF}"><code>SPECTrecon.fft_conv!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">fft_conv!(output, img, ker, plan)</code></pre><p>Convolve 2D image <code>img</code> with 2D (symmetric!) kernel <code>ker</code> using FFT, storing the result in <code>output</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/42158f34d621d4d51fdf6421c2c0e7dfc0a3d34f/src/fft_convolve.jl#L23-L27">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.fft_conv-Union{Tuple{K}, Tuple{I}, Tuple{AbstractMatrix{I}, AbstractMatrix{K}}} where {I&lt;:Number, K&lt;:Number}" href="#SPECTrecon.fft_conv-Union{Tuple{K}, Tuple{I}, Tuple{AbstractMatrix{I}, AbstractMatrix{K}}} where {I&lt;:Number, K&lt;:Number}"><code>SPECTrecon.fft_conv</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">fft_conv(img, ker; T)</code></pre><p>Convolve 2D image <code>img</code> with 2D (symmetric!) kernel <code>ker</code> using FFT.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/42158f34d621d4d51fdf6421c2c0e7dfc0a3d34f/src/fft_convolve.jl#L53-L56">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.fft_conv_adj!-Tuple{AbstractArray{&lt;:Number, 3}, AbstractArray{&lt;:Number, 3}, AbstractArray{&lt;:Number, 3}, Vector{&lt;:PlanPSF}}" href="#SPECTrecon.fft_conv_adj!-Tuple{AbstractArray{&lt;:Number, 3}, AbstractArray{&lt;:Number, 3}, AbstractArray{&lt;:Number, 3}, Vector{&lt;:PlanPSF}}"><code>SPECTrecon.fft_conv_adj!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">fft_conv_adj!(output, image3, ker3, plans)</code></pre><p>Adjoint of <code>fft_conv</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/42158f34d621d4d51fdf6421c2c0e7dfc0a3d34f/src/fft_convolve.jl#L178-L181">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.fft_conv_adj!-Union{Tuple{T}, Tuple{AbstractMatrix{&lt;:Number}, AbstractMatrix{&lt;:Number}, AbstractMatrix{&lt;:Number}, PlanPSF{T}}} where T" href="#SPECTrecon.fft_conv_adj!-Union{Tuple{T}, Tuple{AbstractMatrix{&lt;:Number}, AbstractMatrix{&lt;:Number}, AbstractMatrix{&lt;:Number}, PlanPSF{T}}} where T"><code>SPECTrecon.fft_conv_adj!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">fft_conv_adj!(output, img, ker, plan)</code></pre><p>Adjoint of <code>fft_conv!</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/42158f34d621d4d51fdf6421c2c0e7dfc0a3d34f/src/fft_convolve.jl#L73-L76">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.fft_conv_adj-Union{Tuple{K}, Tuple{I}, Tuple{AbstractMatrix{I}, AbstractMatrix{K}}} where {I&lt;:Number, K&lt;:Number}" href="#SPECTrecon.fft_conv_adj-Union{Tuple{K}, Tuple{I}, Tuple{AbstractMatrix{I}, AbstractMatrix{K}}} where {I&lt;:Number, K&lt;:Number}"><code>SPECTrecon.fft_conv_adj</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">fft_conv_adj(img, ker; T)</code></pre><p>Adjoint of <code>fft_conv</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/42158f34d621d4d51fdf6421c2c0e7dfc0a3d34f/src/fft_convolve.jl#L128-L131">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.fft_conv_adj2!-Tuple{AbstractArray{&lt;:Number, 3}, AbstractMatrix{&lt;:Number}, AbstractArray{&lt;:Number, 3}, Vector{&lt;:PlanPSF}}" href="#SPECTrecon.fft_conv_adj2!-Tuple{AbstractArray{&lt;:Number, 3}, AbstractMatrix{&lt;:Number}, AbstractArray{&lt;:Number, 3}, Vector{&lt;:PlanPSF}}"><code>SPECTrecon.fft_conv_adj2!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">fft_conv_adj2!(output, image2, ker3, plans)</code></pre><p>Mutating version of adjoint of convolving a 2D <code>image2</code> with each 2D kernel in the 3D array <code>ker3</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/42158f34d621d4d51fdf6421c2c0e7dfc0a3d34f/src/fft_convolve.jl#L205-L209">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.fftshift2!-Tuple{AbstractMatrix, AbstractMatrix}" href="#SPECTrecon.fftshift2!-Tuple{AbstractMatrix, AbstractMatrix}"><code>SPECTrecon.fftshift2!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">fftshift2!(dst, src)</code></pre><p>Same as <code>fftshift</code> in 2d, but non-allocating</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/42158f34d621d4d51fdf6421c2c0e7dfc0a3d34f/src/helper.jl#L109-L112">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.foreach_setup-Tuple{Any}" href="#SPECTrecon.foreach_setup-Tuple{Any}"><code>SPECTrecon.foreach_setup</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs"> foreach_setup(z)</code></pre><p>Return <code>Channel</code> for <code>foreach</code> threaded computation from iterable <code>z</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/42158f34d621d4d51fdf6421c2c0e7dfc0a3d34f/src/foreach.jl#L3-L6">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.imfilterz!-Tuple{PlanPSF}" href="#SPECTrecon.imfilterz!-Tuple{PlanPSF}"><code>SPECTrecon.imfilterz!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">imfilterz!(plan)</code></pre><p>FFT-based convolution of <code>plan.img_compl</code> and kernel <code>plan.ker_compl</code> (not centered), storing result in <code>plan.workmat</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/42158f34d621d4d51fdf6421c2c0e7dfc0a3d34f/src/fft_convolve.jl#L6-L11">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.imrotate!" href="#SPECTrecon.imrotate!"><code>SPECTrecon.imrotate!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">imrotate!(output, image3, θ, plans, ntasks=nthreads)</code></pre><p>In-place version of rotating a 3D <code>image3</code> by <code>θ</code> in counter-clockwise direction (opposite to <code>imrotate</code> in Julia) using <code>foreach</code> with <code>ntasks</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/42158f34d621d4d51fdf6421c2c0e7dfc0a3d34f/src/rotatez.jl#L468-L473">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.imrotate!-Tuple{AbstractArray{&lt;:Number, 3}, AbstractArray{&lt;:Number, 3}, Number, Vector{&lt;:PlanRotate}, Symbol}" href="#SPECTrecon.imrotate!-Tuple{AbstractArray{&lt;:Number, 3}, AbstractArray{&lt;:Number, 3}, Number, Vector{&lt;:PlanRotate}, Symbol}"><code>SPECTrecon.imrotate!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">imrotate!(output, image3, θ, plans, :thread)</code></pre><p>Mutating version of rotating a 3D <code>image3</code> by <code>θ</code> in counter-clockwise direction (opposite of <code>imrotate</code> in Julia) writing result into <code>output</code>, using <code>Threads.@threads</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/42158f34d621d4d51fdf6421c2c0e7dfc0a3d34f/src/rotatez.jl#L529-L535">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.imrotate!-Tuple{AbstractMatrix{&lt;:Number}, AbstractMatrix{&lt;:Number}, Number, PlanRotate{&lt;:Number, RotateMode{:one}}}" href="#SPECTrecon.imrotate!-Tuple{AbstractMatrix{&lt;:Number}, AbstractMatrix{&lt;:Number}, Number, PlanRotate{&lt;:Number, RotateMode{:one}}}"><code>SPECTrecon.imrotate!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">imrotate!(output, img, θ, plan)</code></pre><p>Rotate a 2D image <code>img</code> by angle <code>θ ∈ [0,2π]</code> in counter-clockwise direction (opposite to <code>imrotate</code> in Julia) using 3-pass 1d linear interpolations.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/42158f34d621d4d51fdf6421c2c0e7dfc0a3d34f/src/rotatez.jl#L232-L237">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.imrotate!-Union{Tuple{T}, Tuple{AbstractMatrix{&lt;:Number}, AbstractMatrix{&lt;:Number}, Number, PlanRotate{T, RotateMode{:two}}}} where T" href="#SPECTrecon.imrotate!-Union{Tuple{T}, Tuple{AbstractMatrix{&lt;:Number}, AbstractMatrix{&lt;:Number}, Number, PlanRotate{T, RotateMode{:two}}}} where T"><code>SPECTrecon.imrotate!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">imrotate!(output, img, θ, plan)</code></pre><p>Rotate a 2D image <code>img</code> by angle <code>θ ∈ [0,2π]</code> in counter-clockwise direction (opposite to <code>imrotate</code> in Julia) using 2d bilinear interpolation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/42158f34d621d4d51fdf6421c2c0e7dfc0a3d34f/src/rotatez.jl#L323-L328">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.imrotate-Union{Tuple{I}, Tuple{AbstractMatrix{I}, Number}} where I&lt;:Number" href="#SPECTrecon.imrotate-Union{Tuple{I}, Tuple{AbstractMatrix{I}, Number}} where I&lt;:Number"><code>SPECTrecon.imrotate</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">imrotate(img, θ; method::Symbol=:two)</code></pre><p>Rotate a 2D image <code>img</code> by angle <code>θ ∈ [0,2π]</code> in counter-clockwise direction (opposite to <code>imrotate</code> in Julia) using either 2d linear interpolation (for <code>:two</code>) or 3-pass 1D interpolation (for <code>:one</code>)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/42158f34d621d4d51fdf6421c2c0e7dfc0a3d34f/src/rotatez.jl#L363-L369">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.imrotate_adj!" href="#SPECTrecon.imrotate_adj!"><code>SPECTrecon.imrotate_adj!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">imrotate_adj!(output, image3, θ, plans, ntasks=nthreads)</code></pre><p>Adjoint of <code>imrotate!</code> using <code>foreach</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/42158f34d621d4d51fdf6421c2c0e7dfc0a3d34f/src/rotatez.jl#L485-L488">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.imrotate_adj!-Tuple{AbstractArray{&lt;:Number, 3}, AbstractArray{&lt;:Number, 3}, Number, Vector{&lt;:PlanRotate}, Symbol}" href="#SPECTrecon.imrotate_adj!-Tuple{AbstractArray{&lt;:Number, 3}, AbstractArray{&lt;:Number, 3}, Number, Vector{&lt;:PlanRotate}, Symbol}"><code>SPECTrecon.imrotate_adj!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">imrotate_adj!(output, image3, θ, plans, :thread)</code></pre><p>Adjoint of <code>imrotate!</code> using <code>@threads</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/42158f34d621d4d51fdf6421c2c0e7dfc0a3d34f/src/rotatez.jl#L547-L550">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.imrotate_adj!-Tuple{AbstractMatrix{&lt;:Number}, AbstractMatrix{&lt;:Number}, Number, PlanRotate{&lt;:Number, RotateMode{:one}}}" href="#SPECTrecon.imrotate_adj!-Tuple{AbstractMatrix{&lt;:Number}, AbstractMatrix{&lt;:Number}, Number, PlanRotate{&lt;:Number, RotateMode{:one}}}"><code>SPECTrecon.imrotate_adj!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">imrotate_adj!(output, img, θ, plan)</code></pre><p>Adjoint of <code>imrotate!</code> for a 2D image using 3-pass 1d linear interpolations.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/42158f34d621d4d51fdf6421c2c0e7dfc0a3d34f/src/rotatez.jl#L279-L283">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.imrotate_adj!-Union{Tuple{T}, Tuple{AbstractMatrix{&lt;:Number}, AbstractMatrix{&lt;:Number}, Number, PlanRotate{T, RotateMode{:two}}}} where T" href="#SPECTrecon.imrotate_adj!-Union{Tuple{T}, Tuple{AbstractMatrix{&lt;:Number}, AbstractMatrix{&lt;:Number}, Number, PlanRotate{T, RotateMode{:two}}}} where T"><code>SPECTrecon.imrotate_adj!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">imrotate_adj!(output, img, θ, plan)</code></pre><p>Adjoint of <code>imrotate!</code> for a 2D image using 2D bilinear interpolation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/42158f34d621d4d51fdf6421c2c0e7dfc0a3d34f/src/rotatez.jl#L383-L387">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.imrotate_adj-Union{Tuple{I}, Tuple{AbstractMatrix{I}, Number}} where I&lt;:Number" href="#SPECTrecon.imrotate_adj-Union{Tuple{I}, Tuple{AbstractMatrix{I}, Number}} where I&lt;:Number"><code>SPECTrecon.imrotate_adj</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">imrotate_adj(img, θ; method::Symbol=:two)</code></pre><p>Adjoint of rotating a 2D image <code>img</code> by angle <code>θ ∈ [0,2π]</code> in counter-clockwise direction (opposite to <code>imrotate</code> in Julia) using either 2d linear interpolations or 3-pass 1D interpolation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/42158f34d621d4d51fdf6421c2c0e7dfc0a3d34f/src/rotatez.jl#L417-L422">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.linearinterp!-Tuple{LinearInterpolators.SparseInterpolators.SparseInterpolator, Number, Number, Int64}" href="#SPECTrecon.linearinterp!-Tuple{LinearInterpolators.SparseInterpolators.SparseInterpolator, Number, Number, Int64}"><code>SPECTrecon.linearinterp!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">linearinterp!(A, s, e, len)</code></pre><p>Assign key values in <code>SparseInterpolator</code> (linear) <code>A</code> that are calculated from <code>s</code>, <code>e</code> and <code>len</code>. <code>s</code> means start (x[1]) <code>e</code> means end (x[end]) <code>len</code> means length (length(x))</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/42158f34d621d4d51fdf6421c2c0e7dfc0a3d34f/src/rotatez.jl#L11-L18">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.mlem!-Tuple{AbstractArray, AbstractArray, AbstractArray, AbstractArray, Union{AbstractArray, LinearMapsAA.LinearMapAO}}" href="#SPECTrecon.mlem!-Tuple{AbstractArray, AbstractArray, AbstractArray, AbstractArray, Union{AbstractArray, LinearMapsAA.LinearMapAO}}"><code>SPECTrecon.mlem!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">mlem!(out, x0, ynoisy, background, A; niter = 20)</code></pre><p>Inplace version of ML-EM algorithm for emission tomography image reconstruction.</p><ul><li><code>out</code>: Output</li><li><code>x0</code>: Initial guess</li><li><code>ynoisy</code>: (Noisy) measurements</li><li><code>background</code>: Background effects, e.g., scatters</li><li><code>A</code>: System matrix</li><li><code>niter</code>: Number of iterations</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/42158f34d621d4d51fdf6421c2c0e7dfc0a3d34f/src/ml-os-em.jl#L9-L18">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.mlem-Tuple{AbstractArray, Vararg{Any}}" href="#SPECTrecon.mlem-Tuple{AbstractArray, Vararg{Any}}"><code>SPECTrecon.mlem</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">mlem(x0, ynoisy, background, A; niter = 20)</code></pre><p>ML-EM algorithm for emission tomography image reconstruction.</p><ul><li><code>x0</code>: Initial guess</li><li><code>ynoisy</code>: (Noisy) measurements</li><li><code>background</code>: Background effects, e.g., scatters</li><li><code>A</code>: System matrix</li><li><code>niter</code>: Number of iterations</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/42158f34d621d4d51fdf6421c2c0e7dfc0a3d34f/src/ml-os-em.jl#L50-L58">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.mul3dj!-Tuple{AbstractArray{&lt;:Any, 3}, AbstractMatrix, Int64}" href="#SPECTrecon.mul3dj!-Tuple{AbstractArray{&lt;:Any, 3}, AbstractMatrix, Int64}"><code>SPECTrecon.mul3dj!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">mul3dj!(mat3d, mat2d, j)</code></pre><p>Non-allocating <code>mat3d[:,j,:] *= mat2d</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/42158f34d621d4d51fdf6421c2c0e7dfc0a3d34f/src/helper.jl#L298-L301">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.osem!-Tuple{AbstractArray, AbstractArray, AbstractArray, AbstractArray, Union{Vector{AbstractArray}, Vector{LinearMapsAA.LinearMapAO}}}" href="#SPECTrecon.osem!-Tuple{AbstractArray, AbstractArray, AbstractArray, AbstractArray, Union{Vector{AbstractArray}, Vector{LinearMapsAA.LinearMapAO}}}"><code>SPECTrecon.osem!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">osem!(out, x0, ynoisy, background, Ab; niter = 20)</code></pre><p>OS-EM algorithm for SPECT reconstruction.</p><ul><li><code>out</code>: Output</li><li><code>x0</code>: Initial estimate</li><li><code>ynoisy</code>: (Noisy) measurements</li><li><code>background</code>: Background effects, e.g., scatters</li><li><code>Ab</code>: Vector of system matrix</li><li><code>niter</code>: Number of iterations</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/42158f34d621d4d51fdf6421c2c0e7dfc0a3d34f/src/ml-os-em.jl#L85-L94">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.osem-Tuple{AbstractArray, Vararg{Any}}" href="#SPECTrecon.osem-Tuple{AbstractArray, Vararg{Any}}"><code>SPECTrecon.osem</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">osem(x0, ynoisy, background, Ab; niter = 20)</code></pre><p>OS-EM algorithm for SPECT reconstruction.</p><ul><li><code>x0</code>: Initial guess</li><li><code>ynoisy</code>: (Noisy) measurements</li><li><code>background</code>: Background effects, e.g., scatters</li><li><code>Ab</code>: Vector of system matrix</li><li><code>niter</code>: Number of iterations</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/42158f34d621d4d51fdf6421c2c0e7dfc0a3d34f/src/ml-os-em.jl#L132-L140">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.pad2sizezero!-Union{Tuple{T}, Tuple{AbstractMatrix{T}, AbstractMatrix, Tuple{Int64, Int64}}} where T" href="#SPECTrecon.pad2sizezero!-Union{Tuple{T}, Tuple{AbstractMatrix{T}, AbstractMatrix, Tuple{Int64, Int64}}} where T"><code>SPECTrecon.pad2sizezero!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">pad2sizezero!(output, img, padsize)</code></pre><p>Non-allocating version of padding: `output[pad<em>dims[1]+1 : pad</em>dims[1]+dims[1],         pad<em>dims[2]+1 : pad</em>dims[2]+dims[2]]) .= img</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/42158f34d621d4d51fdf6421c2c0e7dfc0a3d34f/src/helper.jl#L61-L67">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.pad_it!-Union{Tuple{T}, Tuple{D}, Tuple{AbstractArray{T, D}, Tuple{Vararg{Int64, D}}}} where {D, T&lt;:Number}" href="#SPECTrecon.pad_it!-Union{Tuple{T}, Tuple{D}, Tuple{AbstractArray{T, D}, Tuple{Vararg{Int64, D}}}} where {D, T&lt;:Number}"><code>SPECTrecon.pad_it!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">pad_it!(X, padsize)</code></pre><p>Zero-pad <code>X</code> to <code>padsize</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/42158f34d621d4d51fdf6421c2c0e7dfc0a3d34f/src/helper.jl#L85-L88">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.padrepl!-Tuple{AbstractMatrix, AbstractMatrix, NTuple{4, Int64}}" href="#SPECTrecon.padrepl!-Tuple{AbstractMatrix, AbstractMatrix, NTuple{4, Int64}}"><code>SPECTrecon.padrepl!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">padrepl!(output, img, padsize)</code></pre><p>Pad with replication from <code>img</code> into <code>output</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/42158f34d621d4d51fdf6421c2c0e7dfc0a3d34f/src/helper.jl#L40-L43">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.padzero!-Union{Tuple{T}, Tuple{AbstractMatrix{T}, AbstractMatrix, NTuple{4, Int64}}} where T" href="#SPECTrecon.padzero!-Union{Tuple{T}, Tuple{AbstractMatrix{T}, AbstractMatrix, NTuple{4, Int64}}} where T"><code>SPECTrecon.padzero!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">padzero!(output, img, pad_x, pad_y)</code></pre><p>Mutating version of padding a 2D image by filling zeros. Output has size <code>(size(img, 1) + padsize[1] + padsize[2], size(img, 2) + padsize[3] + padsize[4])</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/42158f34d621d4d51fdf6421c2c0e7dfc0a3d34f/src/helper.jl#L17-L21">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.plan_psf-Tuple{}" href="#SPECTrecon.plan_psf-Tuple{}"><code>SPECTrecon.plan_psf</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">plan_psf( ; nx::Int, nz::Int, px::Int, pz::Int, nthread::Int, T::DataType)</code></pre><p>Make Vector of structs for storing work arrays and factors for 2D convolution with SPECT depth-dependent PSF model, threaded across planes parallel to detector. Option</p><ul><li><code>nx::Int = 128</code></li><li><code>nz::Int = nx</code></li><li><code>px::Int = 1</code></li><li><code>pz::Int = px</code> PSF size is <code>px × pz</code></li><li><code>T</code> : datatype of work arrays, defaults to <code>Float32</code></li><li><code>nthread::Int</code> # of threads, defaults to <code>Threads.nthreads()</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/42158f34d621d4d51fdf6421c2c0e7dfc0a3d34f/src/plan-psf.jl#L86-L98">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.plan_rotate-Tuple{Int64}" href="#SPECTrecon.plan_rotate-Tuple{Int64}"><code>SPECTrecon.plan_rotate</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">plan_rotate(nx::Int; T::DataType, method::Symbol)</code></pre><p>Make <code>Vector</code> of <code>PlanRotate</code> structs for storing work arrays and factors for threaded rotation of a stack of 2D square images.</p><p><strong>Input</strong></p><ul><li><code>nx::Int</code> must equal to <code>ny</code> (square images only)</li></ul><p><strong>Option</strong></p><ul><li><code>T</code> : datatype of work arrays, defaults to <code>Float32</code></li><li><code>method::Symbol</code> : default is <code>:two</code> for 2D interpolation; use <code>:one</code> for 3-pass rotation with 1D interpolation</li><li><code>nthread::Int</code> : default to <code>Threads.nthreads()</code> The other useful option is <code>1</code> when rotating just one image.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/42158f34d621d4d51fdf6421c2c0e7dfc0a3d34f/src/plan-rotate.jl#L80-L95">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.plus1di!-Tuple{AbstractMatrix, AbstractVector, Int64}" href="#SPECTrecon.plus1di!-Tuple{AbstractMatrix, AbstractVector, Int64}"><code>SPECTrecon.plus1di!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">plus1di!(mat2d, mat1d)</code></pre><p>Non-allocating <code>mat2d[i, :] += mat1d</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/42158f34d621d4d51fdf6421c2c0e7dfc0a3d34f/src/helper.jl#L148-L151">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.plus1dj!-Tuple{AbstractMatrix, AbstractVector, Int64}" href="#SPECTrecon.plus1dj!-Tuple{AbstractMatrix, AbstractVector, Int64}"><code>SPECTrecon.plus1dj!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">plus1dj!(mat2d, mat1d)</code></pre><p>Non-allocating <code>mat2d[:, j] += mat1d</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/42158f34d621d4d51fdf6421c2c0e7dfc0a3d34f/src/helper.jl#L167-L170">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.plus2di!-Tuple{AbstractVector, AbstractMatrix, Int64}" href="#SPECTrecon.plus2di!-Tuple{AbstractVector, AbstractMatrix, Int64}"><code>SPECTrecon.plus2di!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">plus2di!(mat1d, mat2d, i)</code></pre><p>Non-allocating <code>mat1d += mat2d[i,:]</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/42158f34d621d4d51fdf6421c2c0e7dfc0a3d34f/src/helper.jl#L185-L188">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.plus2dj!-Tuple{AbstractVector, AbstractMatrix, Int64}" href="#SPECTrecon.plus2dj!-Tuple{AbstractVector, AbstractMatrix, Int64}"><code>SPECTrecon.plus2dj!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">plus2dj!(mat1d, mat2d, j)</code></pre><p>Non-allocating <code>mat1d += mat2d[:,j]</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/42158f34d621d4d51fdf6421c2c0e7dfc0a3d34f/src/helper.jl#L203-L206">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.plus3di!-Tuple{AbstractMatrix, AbstractArray{&lt;:Any, 3}, Int64}" href="#SPECTrecon.plus3di!-Tuple{AbstractMatrix, AbstractArray{&lt;:Any, 3}, Int64}"><code>SPECTrecon.plus3di!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">plus3di!(mat2d, mat3d, i)</code></pre><p>Non-allocating <code>mat2d += mat3d[i,:,:]</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/42158f34d621d4d51fdf6421c2c0e7dfc0a3d34f/src/helper.jl#L221-L224">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.plus3dj!-Tuple{AbstractMatrix, AbstractArray{&lt;:Any, 3}, Int64}" href="#SPECTrecon.plus3dj!-Tuple{AbstractMatrix, AbstractArray{&lt;:Any, 3}, Int64}"><code>SPECTrecon.plus3dj!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">plus3dj!(mat2d, mat3d, j)</code></pre><p>Non-allocating <code>mat2d += mat3d[:,j,:]</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/42158f34d621d4d51fdf6421c2c0e7dfc0a3d34f/src/helper.jl#L240-L243">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.plus3dk!-Tuple{AbstractMatrix, AbstractArray{&lt;:Any, 3}, Int64}" href="#SPECTrecon.plus3dk!-Tuple{AbstractMatrix, AbstractArray{&lt;:Any, 3}, Int64}"><code>SPECTrecon.plus3dk!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">plus3dk!(mat2d, mat3d, k)</code></pre><p>Non-allocating <code>mat2d += mat3d[:,:,k]</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/42158f34d621d4d51fdf6421c2c0e7dfc0a3d34f/src/helper.jl#L259-L262">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.project!-Tuple{AbstractArray{&lt;:Number, 3}, AbstractArray{&lt;:Number, 3}, SPECTplan}" href="#SPECTrecon.project!-Tuple{AbstractArray{&lt;:Number, 3}, AbstractArray{&lt;:Number, 3}, SPECTplan}"><code>SPECTrecon.project!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">project!(views, image, plan; index)</code></pre><p>Project <code>image</code> into multiple <code>views</code> with indexes <code>index</code> (defaults to <code>1:nview</code>). The 3D <code>views</code> array must be pre-allocated, but need not be initialized.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/42158f34d621d4d51fdf6421c2c0e7dfc0a3d34f/src/project.jl#L137-L141">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.project!-Tuple{AbstractMatrix{&lt;:Number}, AbstractArray{&lt;:Number, 3}, SPECTplan, Int64, Int64}" href="#SPECTrecon.project!-Tuple{AbstractMatrix{&lt;:Number}, AbstractArray{&lt;:Number, 3}, SPECTplan, Int64, Int64}"><code>SPECTrecon.project!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">project!(view, plan, image, thid, viewidx)</code></pre><p>SPECT projection of <code>image</code> into a single <code>view</code> with index <code>viewidx</code>. The <code>view</code> must be pre-allocated but need not be initialized to zero.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/42158f34d621d4d51fdf6421c2c0e7dfc0a3d34f/src/project.jl#L71-L75">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.project!-Tuple{AbstractMatrix{&lt;:Number}, AbstractArray{&lt;:Number, 3}, SPECTplan, Int64}" href="#SPECTrecon.project!-Tuple{AbstractMatrix{&lt;:Number}, AbstractArray{&lt;:Number, 3}, SPECTplan, Int64}"><code>SPECTrecon.project!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">project!(view, plan, image, viewidx)</code></pre><p>SPECT projection of <code>image</code> into a single <code>view</code> with index <code>viewidx</code>. The <code>view</code> must be pre-allocated but need not be initialized to zero.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/42158f34d621d4d51fdf6421c2c0e7dfc0a3d34f/src/project.jl#L5-L9">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.project-Tuple{AbstractArray{&lt;:Number, 3}, AbstractArray{&lt;:Number, 3}, AbstractArray{&lt;:Number, 4}, Number}" href="#SPECTrecon.project-Tuple{AbstractArray{&lt;:Number, 3}, AbstractArray{&lt;:Number, 3}, AbstractArray{&lt;:Number, 4}, Number}"><code>SPECTrecon.project</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">views = project(image, mumap, psfs, dy; interpmeth, kwargs...)</code></pre><p>Convenience method for SPECT forward projector that does all allocation including initializing <code>plan</code>.</p><p>In</p><ul><li><code>image</code> : 3D array <code>(nx,ny,nz)</code></li><li><code>mumap</code> : <code>(nx,ny,nz)</code> 3D attenuation map, possibly zeros()</li><li><code>psfs</code> : 4D PSF array</li><li><code>dy::RealU</code> : pixel size</li></ul><p>Option</p><ul><li><code>interpmeth</code> : <code>:one</code> or <code>:two</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/42158f34d621d4d51fdf6421c2c0e7dfc0a3d34f/src/project.jl#L180-L192">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.project-Tuple{AbstractArray{&lt;:Number, 3}, SPECTplan}" href="#SPECTrecon.project-Tuple{AbstractArray{&lt;:Number, 3}, SPECTplan}"><code>SPECTrecon.project</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">views = project(image, plan ; kwargs...)</code></pre><p>Convenience method for SPECT forward projector that allocates and returns views.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/42158f34d621d4d51fdf6421c2c0e7dfc0a3d34f/src/project.jl#L165-L168">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.psf_gauss-Tuple{}" href="#SPECTrecon.psf_gauss-Tuple{}"><code>SPECTrecon.psf_gauss</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">psf_gauss( ; ny, px, pz, fwhm_start, fwhm_end, fwhm, fwhm_x, fwhm_z, T)</code></pre><p>Create depth-dependent Gaussian PSFs having specified full-width half-maximum (FHWM) values.</p><p><strong>Options</strong></p><ul><li>&#39;ny::Int = 128&#39;</li><li>&#39;px::Int = 11&#39; (should be odd)</li><li>&#39;pz::Int = px&#39; (should be odd)</li><li>&#39;fwhm_start::Real = 1&#39;</li><li>&#39;fwhm_end::Real = 4&#39;</li><li>&#39;fwhm::AbstractVector{&lt;:Real} = LinRange(fwhm<em>start, fwhm</em>end, ny)&#39;</li><li>&#39;fwhm_x::AbstractVector{&lt;:Real} = fwhm,</li><li>&#39;fwhm<em>z::AbstractVector{&lt;:Real} = fwhm</em>x&#39;</li><li>&#39;T::DataType == Float32&#39;</li></ul><p>Returned <code>psf</code> is <code>[px, pz, ny]</code> where each PSF sums to 1.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/42158f34d621d4d51fdf6421c2c0e7dfc0a3d34f/src/psf-gauss.jl#L5-L23">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.rot180!-Tuple{AbstractMatrix, AbstractMatrix}" href="#SPECTrecon.rot180!-Tuple{AbstractMatrix, AbstractMatrix}"><code>SPECTrecon.rot180!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">rot180!(B::AbstractMatrix, A::AbstractMatrix)</code></pre><p>In place version of <code>rot180</code>, returning rotation of <code>A</code> in <code>B</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/42158f34d621d4d51fdf6421c2c0e7dfc0a3d34f/src/rotatez.jl#L177-L180">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.rot_f90!-Tuple{AbstractMatrix, AbstractMatrix, Int64}" href="#SPECTrecon.rot_f90!-Tuple{AbstractMatrix, AbstractMatrix, Int64}"><code>SPECTrecon.rot_f90!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">rot_f90!(output, img, m)</code></pre><p>In-place version of rotating an image by 90/180/270 degrees</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/42158f34d621d4d51fdf6421c2c0e7dfc0a3d34f/src/rotatez.jl#L191-L194">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.rot_f90_adj!-Tuple{AbstractMatrix, AbstractMatrix, Int64}" href="#SPECTrecon.rot_f90_adj!-Tuple{AbstractMatrix, AbstractMatrix, Int64}"><code>SPECTrecon.rot_f90_adj!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">rot_f90_adj!(output, img, m)
The adjoint of rotating an image by 90/180/270 degrees</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/42158f34d621d4d51fdf6421c2c0e7dfc0a3d34f/src/rotatez.jl#L211-L214">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.rotate_x!-Tuple{AbstractMatrix{&lt;:Number}, AbstractMatrix{&lt;:Number}, Number, LinearInterpolators.SparseInterpolators.SparseInterpolator}" href="#SPECTrecon.rotate_x!-Tuple{AbstractMatrix{&lt;:Number}, AbstractMatrix{&lt;:Number}, Number, LinearInterpolators.SparseInterpolators.SparseInterpolator}"><code>SPECTrecon.rotate_x!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">rotate_x!(output, img, tan_θ, interp)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/42158f34d621d4d51fdf6421c2c0e7dfc0a3d34f/src/rotatez.jl#L52-L54">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.rotate_x_adj!-Tuple{AbstractMatrix{&lt;:Number}, AbstractMatrix{&lt;:Number}, Number, LinearInterpolators.SparseInterpolators.SparseInterpolator}" href="#SPECTrecon.rotate_x_adj!-Tuple{AbstractMatrix{&lt;:Number}, AbstractMatrix{&lt;:Number}, Number, LinearInterpolators.SparseInterpolators.SparseInterpolator}"><code>SPECTrecon.rotate_x_adj!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">rotate_x_adj!(output, img, tan_θ, interp)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/42158f34d621d4d51fdf6421c2c0e7dfc0a3d34f/src/rotatez.jl#L76-L78">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.rotate_y!-Tuple{AbstractMatrix{&lt;:Number}, AbstractMatrix{&lt;:Number}, Number, LinearInterpolators.SparseInterpolators.SparseInterpolator}" href="#SPECTrecon.rotate_y!-Tuple{AbstractMatrix{&lt;:Number}, AbstractMatrix{&lt;:Number}, Number, LinearInterpolators.SparseInterpolators.SparseInterpolator}"><code>SPECTrecon.rotate_y!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">rotate_y!(output, img, sin_θ, interp)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/42158f34d621d4d51fdf6421c2c0e7dfc0a3d34f/src/rotatez.jl#L100-L102">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.rotate_y_adj!-Tuple{AbstractMatrix{&lt;:Number}, AbstractMatrix{&lt;:Number}, Number, LinearInterpolators.SparseInterpolators.SparseInterpolator}" href="#SPECTrecon.rotate_y_adj!-Tuple{AbstractMatrix{&lt;:Number}, AbstractMatrix{&lt;:Number}, Number, LinearInterpolators.SparseInterpolators.SparseInterpolator}"><code>SPECTrecon.rotate_y_adj!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">rotate_y_adj!(output, img, sin_θ, interp)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/42158f34d621d4d51fdf6421c2c0e7dfc0a3d34f/src/rotatez.jl#L124-L126">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.rotl90!-Tuple{AbstractMatrix, AbstractMatrix}" href="#SPECTrecon.rotl90!-Tuple{AbstractMatrix, AbstractMatrix}"><code>SPECTrecon.rotl90!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">rotl90!(B::AbstractMatrix, A::AbstractMatrix)</code></pre><p>In place version of <code>rotl90</code>, returning rotation of <code>A</code> in <code>B</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/42158f34d621d4d51fdf6421c2c0e7dfc0a3d34f/src/rotatez.jl#L149-L152">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.rotr90!-Tuple{AbstractMatrix, AbstractMatrix}" href="#SPECTrecon.rotr90!-Tuple{AbstractMatrix, AbstractMatrix}"><code>SPECTrecon.rotr90!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">rotr90!(B::AbstractMatrix, A::AbstractMatrix)</code></pre><p>In place version of <code>rotr90</code>, returning rotation of <code>A</code> in <code>B</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/42158f34d621d4d51fdf6421c2c0e7dfc0a3d34f/src/rotatez.jl#L163-L166">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SPECTrecon.scale3dj!-Tuple{AbstractMatrix, AbstractArray{&lt;:Any, 3}, Int64, Number}" href="#SPECTrecon.scale3dj!-Tuple{AbstractMatrix, AbstractArray{&lt;:Any, 3}, Int64, Number}"><code>SPECTrecon.scale3dj!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">scale3dj!(mat2d, mat3d, j, s)</code></pre><p>Non-allocating <code>mat2d = s * mat3d[:,j,:]</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JeffFessler/SPECTrecon.jl/blob/42158f34d621d4d51fdf6421c2c0e7dfc0a3d34f/src/helper.jl#L278-L281">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Home</a><a class="docs-footer-nextpage" href="../history/">History »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.19 on <span class="colophon-date" title="Sunday 12 June 2022 00:00">Sunday 12 June 2022</span>. Using Julia version 1.7.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
